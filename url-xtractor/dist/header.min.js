function isNull(o){return null==o}function objTransform(o){var j=0,k=0,obj={},maxsize=0;for(propList=Object.keys(o),j=0;j<propList.length;j++)o[propList[j]].length>maxsize&&(maxsize=o[propList[j]].length);var a=[];for(j=0;j<maxsize;j++){for(obj={},k=0;k<propList.length;k++)obj[propList[k]]=o[propList[k]][j];a.push(obj)}return a}function selectDivText(element){var doc=document,text=$(element)[0];if(doc.body.createTextRange)(range=document.body.createTextRange()).moveToElementText(text),range.select();else if(window.getSelection){var range,selection=window.getSelection();if(selection.selectAllChildren)selection.selectAllChildren(text);else(range=document.createRange()).selectNodeContents(text),selection.removeAllRanges(),selection.addRange(range)}}function createCookie(name,value,days){if(days){var date=new Date;date.setTime(date.getTime()+24*days*60*60*1e3);var expires="; expires="+date.toGMTString()}else{expires="";document.cookie=name+"="+value+expires+"; path=/"}}function readCookie(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null}function eraseCookie(name){createCookie(name,"",-1)}function getOrdinal(n){if(parseFloat(n)==parseInt(n)&&!isNaN(n)){var s=["th","st","nd","rd"],v=n%100;return n+(s[(v-20)%10]||s[v]||s[0])}return n}function getDecimalChar(){return(0).toFixed(1).charAt(1)}function breadCrumb(elm){elm.innerHTML='<a href="/">HOME</a> &rarr; '+document.location.href.split("/").slice(-1)[0].split(".")[0].toUpperCase()}function ieReadLocalFile(that,callback,encoding){if(that.value&&!(that.value.length<=0)){var request;window.XMLHttpRequest,request=new ActiveXObject("Msxml2.XMLHTTP");var fn=that.value;request.open("get",fn,!0),request.onreadystatechange=function(){4!=request.readyState||200!=request.status&&0!=request.status||callback(request.responseText)},request.send()}}function readLocalFile(that,callback,encoding){var reader=new FileReader;that.files&&that.files[0]&&((reader=new FileReader).onload=function(e){callback(e.target.result)},reader.readAsText(that.files[0],encoding))}function readExcelFile(event,callback,fn,sheet){var j=0,opts="headers:false";sheet&&""!=sheet&&(opts+=',sheetid:"'+sheet.toJson()+'"'),fn||(fn=$("#f1")[0].value.split(/[\\\/]/)[$("#f1")[0].value.split(/[\\\/]/).length-1]);var ext="XLSX";fn.split(".").length>1&&("XLS"===(ext=(ext=fn.split("."))[ext.length-1].toUpperCase())||(ext="XLSX")),alasql("SELECT * FROM "+ext+"(?,{"+opts+"})",[event],function(data){for(j=0;j<data.length;j++)_.isObject(data[j])&&_.isEmpty(data[j])&&data.splice(j,1);alasql('SELECT * INTO CSV(null,{"utf8Bom":false}) FROM ?',[data],function(data){callback(data.replace(/"undefined"/g,""))})})}function loadTextFile(f,callback,event){var fn=$("#f1")[0].value.split(/[\\\/]/)[$("#f1")[0].value.split(/[\\\/]/).length-1],encoding="",sheetname="",elm=$("#txtEncoding")[0],htmlstring="";fn.toLowerCase().endsWith(".xlsx")||fn.toLowerCase().endsWith(".xls")?(htmlstring='<input id="txtEncoding" value="" class="form-control" title="Enter encoding for input file" onchange="loadTextFile($(\'#f1\')[0],assignText)">',elm&&elm.nodeName&&"select"==elm.nodeName.toLowerCase()&&(elm.outerHTML?elm.outerHTML=htmlstring:$("#txtEncoding").replaceWith(htmlstring)),elm=$("#txtEncoding")[0],document&&elm&&elm.nodeName&&"input"===elm.nodeName.toLowerCase()&&(sheetname=elm.value),document&&$("#spanEncoding")[0]&&($("#spanEncoding")[0].innerHTML="SheetName"),readExcelFile(event,callback,fn,sheetname)):(elm&&elm.nodeName&&"input"==elm.nodeName.toLowerCase()&&(htmlstring='<select id="txtEncoding" class="form-control" title="Enter encoding for input file" onchange="loadTextFile($(\'#f1\')[0],assignText)"><option value="" selected="selected">-Default-</option><option value="ISO-8859-1">ISO-8859-1 (Latin No. 1)</option><option value="ISO-8859-2">ISO-8859-2 (Latin No. 2)</option><option value="ISO-8859-3">ISO-8859-3 (Latin No. 3)</option><option value="ISO-8859-4">ISO-8859-4 (Latin No. 4)</option><option value="ISO-8859-5">ISO-8859-5 (Latin/Cyrillic)</option><option value="ISO-8859-6">ISO-8859-6 (Latin/Arabic)</option><option value="ISO-8859-7">ISO-8859-7 (Latin/Greek)</option><option value="ISO-8859-8">ISO-8859-8 (Latin/Hebrew)</option><option value="ISO-8859-9">ISO-8859-9 (Latin No. 5)</option><option value="ISO-8859-13">ISO-8859-13 (Latin No. 7)</option><option value="ISO-8859-15">ISO-8859-15 (Latin No. 9)</option><option value="macintosh">Mac OS Roman</option>\n<option value="UTF-8">UTF-8</option><option value="UTF-16">UTF-16</option><option value="UTF-16BE">UTF-16 (Big-Endian)</option><option value="UTF-16LE">UTF-16 (Little-Endian)</option><option value="UTF-32">UTF-32</option>\n<option value="UTF-32BE">UTF-32 (Big-Endian)</option><option value="UTF-32LE">UTF-32 (Little-Endian)</option>\n<option value="windows-1250">windows-1250 (Win East European)</option><option value="windows-1251">windows-1251 (WinCyrillic)</option><option value="windows-1252">windows-1252 (WinLatin-1)</option><option value="windows-1253">windows-1253 (WinGreek)</option><option value="windows-1254">windows-1254 (Win Turkish)</option><option value="windows-1255">windows-1255 (Win Hebrew)</option><option value="windows-1256">windows-1256 (Win Arabic)</option><option value="windows-1257">windows-1257 (Win Baltic)</option><option value="windows-1258">windows-1257 (Win Vietnamese)</option></select>',elm.outerHTML?elm.outerHTML=htmlstring:$("#txtEncoding").replaceWith(htmlstring)),elm=$("#txtEncoding")[0],document&&elm&&elm.nodeName&&"select"===elm.nodeName.toLowerCase()&&(encoding=elm.value),window.FileReader?readLocalFile(f,callback,encoding):ieReadLocalFile(f,callback,encoding))}"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(n){return n<10?"0"+n:n}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];switch(value&&"object"==typeof value&&"function"==typeof value.toJSON&&(value=value.toJSON(key)),"function"==typeof rep&&(value=rep.call(holder,key,value)),typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value)return"null";if(gap+=indent,partial=[],"[object Array]"===Object.prototype.toString.apply(value)){for(length=value.length,i=0;i<length;i+=1)partial[i]=str(i,value)||"null";return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&"object"==typeof rep)for(length=rep.length,i=0;i<length;i+=1)"string"==typeof rep[i]&&(v=str(k=rep[i],value))&&partial.push(quote(k)+(gap?": ":":")+v);else for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(v=str(k,value))&&partial.push(quote(k)+(gap?": ":":")+v);return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}"function"!=typeof JSON.stringify&&(JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="","number"==typeof space)for(i=0;i<space;i+=1)indent+=" ";else"string"==typeof space&&(indent=space);if(rep=replacer,replacer&&"function"!=typeof replacer&&("object"!=typeof replacer||"number"!=typeof replacer.length))throw new Error("JSON.stringify");return str("",{"":value})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.prototype.hasOwnProperty.call(value,k)&&(void 0!==(v=walk(value,k))?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),JSON.unflatten=function(data){"use strict";if(Object(data)!==data||Array.isArray(data))return data;var cur,prop,idx,last,temp,result={};for(var p in data){cur=result,prop="",last=0;do{idx=p.indexOf("/",last),temp=p.substring(last,-1!==idx?idx:void 0),cur=cur[prop]||(cur[prop]=isNaN(parseInt(temp))?{}:[]),prop=temp,last=idx+1}while(idx>=0);cur[prop]=data[p]}return result[""]},JSON.flatten=function(data){var result={};return function recurse(cur,prop){if(Object(cur)!==cur)result[prop]=cur;else if(Array.isArray(cur)){for(var i=0,l=cur.length;i<l;i++)recurse(cur[i],prop?prop+"/"+i:""+i);0==l&&(result[prop]=[])}else{var isEmpty=!0;for(var p in cur)isEmpty=!1,recurse(cur[p],prop?prop+"/"+p:p);isEmpty&&(result[prop]={})}}(data,""),result},JSON.valueArray=function(data){var result="";return function recurse(cur,prop){if(Object(cur)!==cur)result+=cur+"|";else if(Array.isArray(cur)){for(var i=0,l=cur.length;i<l;i++)recurse(cur[i],prop?prop+"/"+i:""+i);0==l&&(result+="|")}else{var isEmpty=!0;for(var p in cur)isEmpty=!1,recurse(cur[p],prop?prop+"/"+p:p);isEmpty&&(result+="|")}}(data,""),result},Object.prototype.size||(Object.size=function(obj){var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size}),JSON.stringifyOnce=function(obj,replacer,indent){var printedObjects=[],printedObjectKeys=[];return JSON.stringify(obj,function(key,value){if(printedObjects.length>2e3)return"object too long";var printedObjIndex=!1;if(printedObjects.forEach(function(obj,index){obj===value&&(printedObjIndex=index)}),""==key)return printedObjects.push(obj),printedObjectKeys.push("root"),value;if(printedObjIndex+""!="false"&&"object"==typeof value)return"root"==printedObjectKeys[printedObjIndex]?"(pointer to root)":"(see "+(value&&value.constructor?value.constructor.name.toLowerCase():typeof value)+" with key "+printedObjectKeys[printedObjIndex]+")";var qualifiedKey=key||"(empty key)";return printedObjects.push(value),printedObjectKeys.push(qualifiedKey),replacer?replacer(key,value):value},indent)},String.prototype.lpad=function(length,pad){if(void 0===pad)pad=" ";for(var str=this;str.length<length;)str=pad+str;return str},String.prototype.zeroPad=function(length){var str=this,negative=!1;return isNaN(str)?str:str.length>length?str.toString():(str<0&&(negative=!0),negative?"0"==(str=str.substring(1).lpad(length,"0")).charAt(0)&&(str="-"+str.substring(1)):str=str.lpad(length,"0"),str)},String.prototype.rpad=function(length,pad,truncate){if(void 0===pad||""===pad)pad=" ";return this.length>=length&&!1===truncate?this:(this+pad.repeat(length)).substring(0,length)},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/g,"")},String.prototype.crunch=function(){return this.replace(/\s{2,}/g," ")},"function"!=typeof String.prototype.repeat&&(String.prototype.repeat=function(n){return n=n||1,Array(n+1).join(this)}),String.prototype.ljust=function(width,pad){return pad=(pad=pad||" ").substr(0,1),this.length<width?this+pad.repeat(width-this.length):this},String.prototype.rjust=function(width,pad){return pad=(pad=pad||" ").substr(0,1),this.length<width?pad.repeat(width-this.length)+this:this},String.prototype.cjust=function(width,pad){if(pad=(pad=pad||" ").substr(0,1),this.length<width-1){var len=width-this.length,remain=len%2==0?"":pad,pads=pad.repeat(Math.floor(len/2));return pads+this+pads+remain}return this.rpad(width)},"function"!=typeof String.prototype.capitalize&&(String.prototype.capitalize=function(){return this.replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()})}),"function"!=typeof String.prototype.toProperCase&&(String.prototype.toProperCase=function(){return this.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})}),"function"!=typeof String.prototype.left&&(String.prototype.left=function(n){return this.substring(0,n)}),"function"!=typeof String.prototype.right&&(String.prototype.right=function(n){return this.substring(this.length-n)}),String.prototype.removePunctuation=function(){return this.replace(/[@+<>"'?\.,-\/#!$%\^&\*;:{}=\-_`~()\[\]\\\|]/g,"")},"function"!=typeof String.prototype.hashCode&&(String.prototype.hashCode=function(){var i,hash=0;if(0===this.length)return hash;for(i=0;i<this.length;i++)hash=(hash<<5)-hash+this.charCodeAt(i),hash|=0;return hash}),"function"!=typeof String.prototype.enclose&&(String.prototype.enclose=function(byChar,escapeByCharWith){if(void 0===byChar&&(byChar=""),void 0===escapeByCharWith&&(escapeByCharWith=""),""!=escapeByCharWith){var re=new RegExp(byChar.regExpEscape(byChar),"gmi");return byChar+this.replace(re,escapeByCharWith+byChar)+byChar}return byChar+this+byChar}),String.prototype.toHtml=function(){return this.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},String.prototype.toXml=function(){return this.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},String.prototype.toCsv=function(sepChar,quoteChar,escapeChar,forceEnclose){void 0===sepChar&&(sepChar=","),void 0===quoteChar&&(quoteChar='"'),void 0===escapeChar&&(escapeChar=quoteChar),void 0===forceEnclose&&(forceEnclose=!1);var encloseit=this.indexOf(quoteChar)>=0||this.indexOf(sepChar)>=0||this.indexOf("\r")>=0||this.indexOf("\n")>=0;return forceEnclose&&(encloseit=!0),encloseit?this.enclose(quoteChar,escapeChar):this},"function"!=typeof String.prototype.isNumeric&&(String.prototype.isNumeric=function(){return!isNaN(parseFloat(this))&&isFinite(this)}),String.prototype.toNumber=function(){var str=this.replace(/[^\d.\-\+eE]/g,"");return str.length>0&&!isNaN(str)&&(str*=1),str},String.prototype.toInteger=function(){return parseInt(this.toNumber().toString(),10)},String.prototype.toFixed=function(dec){var str=this.toNumber().toString();return str.length>0&&!isNaN(str)&&(str=(1*str).toFixed(dec)),String(str)},String.prototype.toDollar=function(dec,dollarsymbol){var str=this.toNumber().toString();if(void 0===dec&&(dec=2),void 0===dollarsymbol&&(dollarsymbol="$"),str.length>0&&!isNaN(str)){var x,x1,x2;x1=(x=(1*str).toFixed(dec).split("."))[0],x2=x.length>1?"."+x[1]:"";for(var re=/(\d+)(\d{3})/;re.test(x1);)x1=x1.replace(re,"$1,$2");str=dollarsymbol+x1+x2}return String(str)},String.prototype.toJson=function(){return this.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")},String.prototype.toSql=function(wrap){return(wrap?"'":"")+this.replace(/'/g,"''")+(wrap?"'":"")},String.prototype.toYaml=function(){return/[\r\n\f\v\t]/g.test(this)?'"'+this.replace(/\t/g,"\\t").replace(/\"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\v/g,"\\v").replace(/"/g,'\\"')+'"':this.indexOf("'")>=0?"'"+this.replace(/'/g,"''")+"'":this},String.prototype.regExpEscape=function(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},"function"!=typeof RegExp.prototype.escape&&(RegExp.prototype.escape=function(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(str){return this.slice(0,str.length)==str}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(str){return this.slice(-str.length)==str}),"function"!=typeof String.prototype.removeDiacritics&&(String.prototype.removeDiacritics=function(){newstr=this;for(var diaChanges=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g},{base:"'",letters:/[\u0060\u00B4\u2018\u2019]/g},{base:'"',letters:/[\u201C\u201D]/g}],i=0;i<diaChanges.length;i++)newstr=newstr.replace(diaChanges[i].letters,diaChanges[i].base);return newstr=newstr.replace(/[\u2018\u2019\u201A]/g,"'"),newstr=newstr.replace(/[\u201C\u201D\u201E]/g,'"'),newstr=newstr.replace(/\u2026/g,"..."),newstr=newstr.replace(/[\u2013\u2014]/g,"-"),newstr=newstr.replace(/\u02C6/g,"^"),newstr=newstr.replace(/\u2039/g,"<").replace(/\u203A/g,">"),newstr=newstr.replace(/[\u02DC\u00A0]/g," "),newstr}),"function"!=typeof String.prototype.isDateMaybe&&(String.prototype.isDateMaybe=function(){var j,s=this.trim(),a=s.split(/[.\/\-]/),d=[{month:!1,day:!1,year:!1},{month:!1,day:!1,year:!1},{month:!1,day:!1,year:!1}];if(1==a.length){if(isNaN(s))try{var t=new Date(s);return!isNaN(t)}catch(e){return!1}return(6===s.length||8===s.length)&&(8==s.length&&(s.substring(0,4)+"/"+s.substring(4,6)+"/"+s.substring(6)).isDateMaybe()||(s.substring(0,2)+"/"+s.substring(2,4)+"/"+s.substring(4)).isDateMaybe())}if(3!=a.length)return!1;for(j=0;j<3;j++){if(a[j].length<1||3==a[j].length||a[j].length>4)return!1;if(isNaN(a[j]))return!1}for(j=0;j<3;j++)if(4==a[j].length){if(1*a[j]<1900||1*a[j]>=2100)return!1;d[j].year=!0}else 1*a[j]>=1&&1*a[j]<=31&&(d[j].day=!0),d[j].year=!0,1*a[j]>=1&&1*a[j]<=12&&(d[j].month=!0);return!!(d[0].month&&d[1].day&&d[2].year)||(!!(d[0].year&&d[1].month&&d[2].day)||!!(d[0].day&&d[1].month&&d[2].year))}),Array.prototype.indexOf||(Array.prototype.indexOf=function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;for((from=from<0?Math.ceil(from):Math.floor(from))<0&&(from+=len);from<len;from++)if(from in this&&this[from]===elt)return from;return-1}),Number.isInteger=Number.isInteger||function(value){return"number"==typeof value&&isFinite(value)&&Math.floor(value)===value};var CSV={delimiter:",",detectedDelimiter:",",autodetect:!0,quote:'"',quoteCharCnt:{"'":0,'"':0},detectedQuote:'"',outputQuote:'"',limit:"",isFirstRowHeader:!0,headerToUpper:!1,headerToLower:!1,skipEmptyRows:!0,skipEmptyRowCnt:0,skip:0,relaxedMode:!0,ignoreQuote:!1,relaxedInfo:{},excelMode:!0,sortNeeded:!1,addSequence:!1,fieldImbalance:!1,fieldImbalanceRows:[],headerImbalance:!1,headerImbalanceRows:[],headerErrors:[],decodeBackslashLiterals:!1,decimalChar:function(){return(0).toFixed(1).charAt(1)},maxColumnsFound:0,headerColumns:0,prevColumnsFound:0,dataRowsFound:0,arHeaderRow:[],table:[],statsCnt:[],displayPoss:"",sortPoss:"",sortIgnoreCase:!1,useStringSub:!1,stringSubMap:[["null","",!1]],unescapeLiterals:function(s){var j,c,n=s.length-1;for(j=0;j<n;j+=1){if("\\"==(c=s.charAt(j)))switch(s.charAt(j+1)){case"\\":c="\\",j+=1;break;case"b":c="\b",j+=1;break;case"f":c="\f",j+=1;break;case"n":c="\n",j+=1;break;case"r":c="\r",j+=1;break;case"t":c="\t",j+=1;break;case"v":c="\v",j+=1;break;case'"':c='"',j+=1;break;case"'":c="'",j+=1;break;case",":c=",",j+=1}a.push(c)}return j==n&&a.push(s.charAt(n)),a.join("")},parse:function(csv,reviver){var j,k,s="",ss="";reviver=reviver||function(r,c,v){return v},this.table=[],this.statsCnt=[],this.arHeaderRow=[],this.maxColumnsFound=0,this.dataRowsFound=0,this.headerColumns=0,this.relaxedInfo={};var start,end,row,savestart,linestart,firstRowColumnsFound,chars,cc,c=0,prevCh="",cnt=0,spacesFound=!1;if(""!==this.limit&&isNaN(this.limit)&&(this.limit=""),""!==this.skip&&isNaN(this.skip)&&(this.skip=0),(""===this.skip||this.skip<0)&&(this.skip=0),this.skip>0){var p=0;for(cnt=0,j=0;j<csv.length;j+=1)if(("\n"==csv.charAt(j)||"\r"==csv.charAt(j)&&(j==csv.length-1||"\n"!=csv.charAt(j+1)))&&(cnt+=1)>=this.skip){p=j+1;break}cnt<this.skip&&(p=csv.length),csv=csv.substr(p)}for(cc=(chars=csv.split("")).length,csv="",detect={comma:0,semi:0,tab:0,pipe:0,colon:0,space:0,caret:0},this.quoteCharCnt={"'":0,'"':0},j=0;j<cc&&(!(j>1)||"\r"!=chars[j]&&"\n"!=chars[j]);j+=1)","==chars[j]&&(detect.comma+=1),";"==chars[j]&&(detect.semi+=1),"\t"==chars[j]&&(detect.tab+=1),"|"==chars[j]&&(detect.pipe+=1),":"==chars[j]&&(detect.colon+=1),"^"==chars[j]&&(detect.caret+=1)," "==chars[j]&&(detect.space+=1);for(this.detectedDelimiter=this.delimiter||",",detect.tab>0&&detect.tab>=detect.comma&&detect.tab>=detect.pipe&&detect.tab>=detect.semi&&detect.tab>=detect.colon&&detect.tab>detect.caret?this.detectedDelimiter="\t":detect.semi>0&&detect.semi>detect.comma&&detect.semi>detect.pipe&&detect.semi>detect.tab&&detect.semi>detect.colon&&detect.semi>detect.caret?this.detectedDelimiter=";":detect.colon>0&&detect.colon>detect.comma&&detect.colon>detect.pipe&&detect.colon>detect.tab&&detect.colon>detect.semi&&detect.colon>detect.caret?this.detectedDelimiter=":":detect.pipe>0&&detect.pipe>detect.comma&&detect.pipe>detect.semi&&detect.pipe>detect.tab&&detect.pipe>detect.colon&&detect.pipe>detect.caret?this.detectedDelimiter="|":detect.caret>0&&detect.caret>detect.comma&&detect.caret>detect.pipe&&detect.caret>detect.semi&&detect.caret>detect.tab&&detect.caret>detect.colon?this.detectedDelimiter="^":(detect.comma>detect.tab&&detect.comma>detect.pipe&&detect.comma>detect.semi&&detect.comma>detect.colon&&(detect.comma,detect.caret),this.detectedDelimiter=","),0===detect.tab&&0===detect.comma&&0===detect.pipe&&0===detect.colon&&0===detect.semi&&0===detect.caret&&detect.space>0&&(this.detectedDelimiter=" "),this.autodetect&&(this.delimiter=this.detectedDelimiter),this.skipEmptyRowCnt=0;c<cc;)if(!this.skipEmptyRows||"\r"!=chars[c]&&"\n"!=chars[c]){for(this.table.push(row=[]),this.addSequence&&0===row.length&&1===this.table.length&&this.isFirstRowHeader?row.push("#"):this.addSequence&&0===row.length&&row.push(""+(cnt+1-(this.isFirstRowHeader?1:0))),spacesFound=!1,linestart=c;c<cc&&"\r"!==chars[c]&&"\n"!==chars[c];){if(savestart=start=end=c,this.relaxedMode){for(;" "===chars[c];)c+=1,spacesFound=!0;chars[c]!==this.quote||this.ignoreQuote?c=savestart:(spacesFound&&!this.relaxedInfo[""+(this.table.length+0)]&&(this.relaxedInfo[""+(this.table.length+0)]={error:1,column:c-linestart+1}),start=c)}if(this.excelMode&&"="===chars[c]&&c+1<cc&&chars[c+1]===this.quote&&(start=c+=1,!0),this.quote!==chars[c]||this.ignoreQuote)for(prevCh="";c<cc&&"\r"!==chars[c]&&"\n"!==chars[c]&&(chars[c]!==this.delimiter||this.decodeBackslashLiterals)&&(chars[c]!==this.delimiter||!this.decodeBackslashLiterals||"\\"===prevCh);)prevCh=chars[c],end=c+=1;else{for(start=end=c+=1,this.quoteCharCnt[this.quote]+=1;c<cc;){if(chars[c]===this.quote){if(this.quote!==chars[c+1])break;chars[c+=1]=""}end=c+=1}for(chars[c]===this.quote?(c+=1)<cc&&"\r"!==chars[c]&&"\n"!==chars[c]&&this.delimiter!==chars[c]&&(this.relaxedInfo[""+(this.table.length+0)]||(this.relaxedInfo[""+(this.table.length+0)]={error:2,column:c-linestart+1})):this.relaxedInfo[""+(this.table.length+0)]||(this.relaxedInfo[""+(this.table.length+0)]={error:3,column:c-linestart+1});c<cc&&"\r"!==chars[c]&&"\n"!==chars[c]&&this.delimiter!==chars[c];)c+=1}if(row.push(reviver(this.table.length-1,row.length,chars.slice(start,end).join(""))),this.decodeBackslashLiterals&&(row[row.length-1]=this.unescapeLiterals(row[row.length-1]))," "==this.delimiter)for(;c<cc&&chars[c]==this.delimiter;)c+=1;this.delimiter===chars[c]&&(c+=1)}if(chars[c-1]==this.delimiter&&" "!=this.delimiter&&row.push(reviver(this.table.length-1,row.length,"")),row.length>this.maxColumnsFound&&(this.maxColumnsFound=row.length),"\r"===chars[c]&&(c+=1),"\n"===chars[c]&&(c+=1),!this.isFirstRowHeader||cnt>0)for(j=0;j<row.length;j+=1){if((j>=this.statsCnt.length||0===cnt)&&(this.statsCnt[j]={dateCnt:0,intCnt:0,realCnt:0,emptyCnt:0,bitCnt:0,logicalCnt:0,equalUsed:!1,fieldType:"",fieldDecs:0,fieldPrec:0,fldMinLen:Number.MAX_VALUE,fldMaxLen:0}),s=j<row.length?row[j].replace(/^\s+|\s+$/g,""):"",this.excelMode&&s.length>2&&'="'===s.substr(0,2)&&s.substr(s.length-1)===this.quote){this.statsCnt[j].equalUsed=!0;var e=new RegExp(this.quote+this.quote,"gmi");s=row[j]=s.substr(2,s.length-3).replace(e,this.quote)}if(this.useStringSub)for(z=0;z<this.stringSubMap.length;z+=1)if(s.toUpperCase()==this.stringSubMap[z][0].toUpperCase()){s=this.stringSubMap[z][1];break}var ch="'";if(ch===this.quote&&(ch='"'),s.charAt(0)===ch&&s.endsWith(ch)&&(this.quoteCharCnt[ch]+=1),""===s?this.statsCnt[j].emptyCnt+=1:(s.length<this.statsCnt[j].fldMinLen&&(this.statsCnt[j].fldMinLen=s.length),s.length>this.statsCnt[j].fldMaxLen&&(this.statsCnt[j].fldMaxLen=s.length)),""!==(ss=s)&&ss.isNumeric()){this.statsCnt[j].realCnt+=1;var dc=ss.split(this.decimalChar());dc[0].length>this.statsCnt[j].fieldPrec&&(this.statsCnt[j].fieldPrec=dc[0].length),dc.length>1&&dc[1].length>this.statsCnt[j].fieldDecs&&(this.statsCnt[j].fieldDecs=dc[1].length),s.indexOf(this.decimalChar())<0&&(this.statsCnt[j].intCnt+=1),"0"!==s&&"1"!==s||(this.statsCnt[j].bitCnt+=1)}s.isDateMaybe()&&(this.statsCnt[j].dateCnt+=1),"TRUE"!==s.toUpperCase()&&"FALSE"!==s.toUpperCase()||(this.statsCnt[j].logicalCnt+=1)}if(cnt+=1,""!==this.limit&&cnt-(this.isFirstRowHeader?1:0)>=1*this.limit)break}else c+=1,this.skipEmptyRowCnt+=1;if(this.dataRowsFound=cnt<=0?0:cnt-(this.isFirstRowHeader?1:0),this.headerErrors=[],this.isFirstRowHeader&&this.table.length>0){for(this.arHeaderRow=this.table.shift(),this.headerColumns=this.arHeaderRow.length,j=0;j<this.headerColumns;j+=1)""===this.arHeaderRow[j].trim()&&this.headerErrors.push({error:1,field:j+1});for(j=0;j<this.maxColumnsFound;j+=1)this.arHeaderRow[j]&&""!==this.arHeaderRow[j]||(this.arHeaderRow[j]="FIELD"+(j+1)),this.arHeaderRow[j]=this.arHeaderRow[j].trim()}for(this.fieldImbalance=!1,this.fieldImbalanceRows=[],this.headerImbalanceRows=[],this.headerImbalance=!1,firstRowColumnsFound=this.dataRowsFound>0?this.table[0].length:0,k=0;k<this.table.length;k+=1){if(this.table[k].length<this.maxColumnsFound)for(j=this.table[k].length;j<this.maxColumnsFound;j+=1)j>=this.statsCnt.length&&(this.statsCnt[j]={dateCnt:0,intCnt:0,realCnt:0,emptyCnt:0,bitCnt:0,logicalCnt:0,equalUsed:!1,fieldType:"",fieldDecs:0,fieldPrec:0,fldMinLen:Number.MAX_VALUE,fldMaxLen:0}),this.statsCnt[j].emptyCnt+=1;this.isFirstRowHeader&&this.headerColumns!=this.table[k].length&&(this.headerImbalance=!0,this.headerImbalanceRows.length<5&&this.headerImbalanceRows.push(k+2)),this.isFirstRowHeader||firstRowColumnsFound==this.table[k].length||(this.fieldImbalance=!0,this.fieldImbalanceRows.length<5&&this.fieldImbalanceRows.push(k+1))}if(this.arHeaderRow.length>0)for(j=0;j<this.arHeaderRow.length;j+=1)this.determineCsvColType(j);else if(this.table.length>0)for(j=0;j<this.maxColumnsFound;j+=1)this.arHeaderRow[j]&&""!==this.arHeaderRow[j]||(this.arHeaderRow[j]="FIELD"+(j+1)),this.determineCsvColType(j);for(j=0;j<this.arHeaderRow.length;j+=1)this.headerToUpper&&(this.arHeaderRow[j]=this.arHeaderRow[j].toUpperCase()),this.headerToLower&&(this.arHeaderRow[j]=this.arHeaderRow[j].toLowerCase());return""!==this.sortPoss&&this.table.sort(this.sortCsv),this.quoteCharCnt['"']>=this.quoteCharCnt["'"]?this.detectedQuote='"':this.detectedQuote="'",0},setSortFlds:function(flds){CSV.sortPoss=flds.trim()},sortCsv:function(a,b){if(""===CSV.sortPoss)return 0;for(p=CSV.sortPoss.split(","),j=0;j<p.length;j+=1)switch(q[j]=1,t[j]="","D"==p[j].right(1).toUpperCase()&&(q[j]=-1,p[j]=p[j].left(p[j].length-1)),p[j].left(1).toUpperCase()){case"C":t[j]="C",p[j]=p[j].right(p[j].length-1);break;case"N":t[j]="N",p[j]=p[j].right(p[j].length-1)}for(j=0;j<p.length;j+=1)isNaN(p[j])?p[j]=-1:p[j]=1*p[j]-1;for(j=0;j<p.length;j+=1)p[j]>=a.length&&(p[j]=-1);for(j=0;j<p.length;j+=1)if(!(p[j]<0))if(isNaN(a[p[j]].replace(/[\$,]/g,""))||isNaN(b[p[j]].replace(/[\$,]/g,""))||CSV.dataRowsFound!=CSV.statsCnt[p[j]].realCnt+CSV.statsCnt[p[j]].emptyCnt||"C"==t[j])if(CSV.sortIgnoreCase){if(a[p[j]].toUpperCase()<b[p[j]].toUpperCase())return-1*q[j];if(a[p[j]].toUpperCase()>b[p[j]].toUpperCase())return 1*q[j]}else{if(a[p[j]]<b[p[j]])return-1*q[j];if(a[p[j]]>b[p[j]])return 1*q[j]}else{if(1*a[p[j]].replace(/[\$,]/g,"")<1*b[p[j]].replace(/[\$,]/g,""))return-1*q[j];if(1*a[p[j]].replace(/[\$,]/g,"")>1*b[p[j]].replace(/[\$,]/g,""))return 1*q[j]}return 0},determineCsvColType:function(colPos){return 0===this.table.length?"":(colPos>=this.statsCnt.length&&(this.statsCnt[colPos]={dateCnt:0,intCnt:0,realCnt:0,emptyCnt:0,bitCnt:0,logicalCnt:0,fieldType:""}),this.table.length==this.statsCnt[colPos].bitCnt?(this.statsCnt[colPos].fieldType="B","B"):this.table.length==this.statsCnt[colPos].logicalCnt?(this.statsCnt[colPos].fieldType="L","L"):this.table.length==this.statsCnt[colPos].dateCnt?(this.statsCnt[colPos].fieldType="D","D"):this.table.length==this.statsCnt[colPos].intCnt?(this.statsCnt[colPos].fieldType="I","I"):this.table.length==this.statsCnt[colPos].realCnt?(this.statsCnt[colPos].fieldType="N","N"):this.statsCnt[colPos].bitCnt>0&&this.table.length==this.statsCnt[colPos].bitCnt+this.statsCnt[colPos].emptyCnt?(this.statsCnt[colPos].fieldType="B","B"):this.statsCnt[colPos].logicalCnt>0&&this.table.length==this.statsCnt[colPos].logicalCnt+this.statsCnt[colPos].emptyCnt?(this.statsCnt[colPos].fieldType="L","L"):this.statsCnt[colPos].dateCnt>0&&this.table.length==this.statsCnt[colPos].dateCnt+this.statsCnt[colPos].emptyCnt?(this.statsCnt[colPos].fieldType="D","D"):this.statsCnt[colPos].intCnt>0&&this.table.length==this.statsCnt[colPos].intCnt+this.statsCnt[colPos].emptyCnt?(this.statsCnt[colPos].fieldType="I","I"):this.statsCnt[colPos].realCnt>0&&this.table.length==this.statsCnt[colPos].realCnt+this.statsCnt[colPos].emptyCnt?(this.statsCnt[colPos].fieldType="N","N"):(this.statsCnt[colPos].fieldType="VC","VC"))},stringify:function(eol,replacer){replacer=replacer||function(r,c,v){return v};var c,cc,r,csv="";eol=eol||"\n",this.isFirstRowHeader&&this.table.unshift(this.arHeaderRow);var cell,rr=this.table.length,re=new RegExp("["+this.delimiter+"\r\n]","gmi");for(r=0;r<rr;r+=1)for(r&&(csv+=eol),c=0,cc=this.table[r].length;c<cc;c+=1)c&&(csv+=this.delimiter),cell=replacer(r,c,this.table[r][c]),re.test(cell)&&(cell=this.outputQuote+cell.replace(/"/g,this.outputQuote+this.outputQuote)+this.outputQuote),csv+=cell||0===cell?cell:"";return csv}},j,k,i,mye=eval,myhid=!0;function SeqObj(n){this.n=n-1||0,this.nInit=this.n,this.next=function(){return this.n+=1},this.curr=function(){return this.n},this.reset=function(){this.n=this.nInit}}function queryGetVal(CSV,s,rownum){if(CSV){var j,k;for(k=0;k<CSV.maxColumnsFound;k+=1)eval("var f"+(k+1)+"=''"),eval("var F"+(k+1)+"=''"),eval("var h"+(k+1)+"=''"),eval("var H"+(k+1)+"=''");for(k=0;k<CSV.arHeaderRow.length;k+=1){eval("var h"+(k+1)+"=CSV.arHeaderRow["+k+"]"),eval("var H"+(k+1)+"=CSV.arHeaderRow["+k+"].toUpperCase()");try{eval("var "+CSV.arHeaderRow[k]+"=CSV.arHeaderRow["+k+"]")}catch(e){}}if(rownum>=0)for(k=0;k<CSV.table[rownum].length;k+=1){eval("var f"+(k+1)+"=CSV.table["+rownum+"]["+k+"]"),eval("var F"+(k+1)+"=CSV.table["+rownum+"]["+k+"].toUpperCase()");try{eval("var "+CSV.arHeaderRow[k]+"=CSV.table["+rownum+"]["+k+"]")}catch(e){}}try{return eval(s)}catch(e){return!0}}}function temGetVal(CSV,s,rownum,seq,options){if(CSV){var j,k,rn=(rownum||0)+1,nr=CSV.table.length,nh=CSV.arHeaderRow.length,nf=0,br="\n",lb="{",rb="}",tab="    ",v="";for(options=options||{},k=0;k<CSV.maxColumnsFound;k+=1)eval("var f"+(k+1)+"=''"),eval("var F"+(k+1)+"=''"),eval("var h"+(k+1)+"=''"),eval("var H"+(k+1)+"=''");for(k=0;k<CSV.arHeaderRow.length;k+=1)eval("var h"+(k+1)+"=CSV.arHeaderRow[k]"),eval("var H"+(k+1)+"=CSV.arHeaderRow[k].toUpperCase()"),options.global&&options.global.length>0&&(eval("h"+(k+1)+"=h"+(k+1)+"."+options.global.join(".")),eval("H"+(k+1)+"=H"+(k+1)+"."+options.global.join(".")));if(rownum>=0)for(k=0;k<CSV.table[rownum].length;k+=1){eval("var f"+(k+1)+"=CSV.table[rownum][k]"),eval("var F"+(k+1)+"=CSV.table[rownum][k].toUpperCase()");try{eval("var "+CSV.arHeaderRow[k]+"=CSV.table[rownum][k]")}catch(e){}v=doTransformations(eval("f"+(k+1)),k,CSV),eval("f"+(k+1)+"=v"),v=doTransformations(eval("F"+(k+1)),k,CSV),eval("F"+(k+1)+"=v"),"f"+(k+1)in options&&(eval("f"+(k+1)+"=f"+(k+1)+"."+options["f"+(k+1)].join(".")),eval("F"+(k+1)+"=F"+(k+1)+"."+options["F"+(k+1)].join("."))),options.global&&options.global.length>0&&(eval("f"+(k+1)+"=f"+(k+1)+"."+options.global.join(".")),eval("F"+(k+1)+"=F"+(k+1)+"."+options.global.join(".")))}nf=rownum>=0?CSV.table[rownum].length:0;var a=s.split("."),b;for(j=0;j<a.length;j+=1)b=a[j].trim().split("("),"csv"==b[0].trim().toLowerCase()&&b.length>1&&")"===b[1].trim()&&(a[j]="csv("+CSV.quote.enclose('"',"\\")+","+CSV.quote.enclose('"',"\\")+")");try{return eval(a.join("."))}catch(e){return""}}}function temHandler(CSV,tem,rownum,seq,temOptions){if(CSV){if(""===tem.trim())return tem;var s=(tem=(tem=tem.replace(/\{\s/gm,"{lb} ").replace(/\{$/gm,"{lb}").replace(/\s\}/gm," {rb}").replace(/^\}/gm,"{rb}")).split(/\r\n|\r|\n/).join("{br}")).replace(/\{/g,"{\n").split(/\{|\}/).join("\n"),j=0,cmd=!1;lines=s.split("\n");for(var t=[];j<lines.length;)cmd&&""!==lines[j]?(t.push(temGetVal(CSV,lines[j],rownum,seq,temOptions)),cmd=!1):""===lines[j]?cmd=!0:t.push(lines[j]),j+=1;return t.join("")}}function csvFromTem(CSV,temHead,tem,temBetween,temFoot,temCond,temOptions){var j;if(CSV){var s="",seqobj=new SeqObj;for(s+=temHandler(CSV,temHead,-1,0),j=0;j<CSV.table.length;j+=1)"false"!=temHandler(CSV,temCond,j,j,null).toString().left(5)&&(s+=temHandler(CSV,tem,j,seqobj.next(),temOptions),j!=CSV.table.length-1&&(s+=temHandler(CSV,temBetween,j,seqobj.curr())));return s+=temHandler(CSV,temFoot,-1,seqobj.curr(),temOptions)}}function csvToTable(CSV,addHeaderIfMissing,addLineNumbers,addSummary,options){var j,k,a,s='<table class="table table-bordered table-hover table-condensed">\n',x=0,v="",sumFields=[];if(CSV){for(options=options||{},a=getFldPosArr(CSV),k=0;k<CSV.maxColumnsFound;k+=1)sumFields.push(0);if(CSV.isFirstRowHeader||addHeaderIfMissing){for(s+="<thead><tr>",addLineNumbers&&(s+="<th>#</th>"),x=0;x<a.length;x+=1)s+='<th title="Field #'+((k=a[x]-1)+1)+'">'+(v=k>CSV.arHeaderRow.length?"FIELD"+k:CSV.arHeaderRow[k]).toHtml().replace(/\r\n|\r|\n/g,"<br/>")+"</th>\n";s+="</tr></thead>\n"}for(s+="<tbody>",j=0;j<CSV.table.length;j+=1){s+="<tr",options&&"attr1"in options&&(""!==options.attr1&&""===options.attr1Row?s+=" "+options.attr1:""!==options.attr1&&"E"===options.attr1Row&&j%2?s+=" "+options.attr1:""===options.attr1||"O"!==options.attr1Row||j%2||(s+=" "+options.attr1),""!==options.attr2&&""===options.attr2Row?s+=" "+options.attr2:""!==options.attr2&&"E"===options.attr2Row&&j%2?s+=" "+options.attr2:""===options.attr2||"O"!==options.attr2Row||j%2||(s+=" "+options.attr2)),s+=">\n",addLineNumbers&&(s+="<td>"+(j+1)+"</td>\n");for(x=0;x<a.length;x+=1)if(v=doTransformations(v=(k=a[x]-1)>=CSV.table[j].length?" ":CSV.table[j][k],k,CSV),!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType)if(""!==v&&"dateOutFormat"in options&&""!==options.dateOutFormat&&CSV.statsCnt[k]&&"D"==CSV.statsCnt[k].fieldType){try{v=moment(v,CSV.dateformat[k]).format(options.dateOutFormat)}catch(e){}s+="<td>"+v.toHtml().replace(/\r\n|\n|\r/g,"<br/>"),s+="</td>\n"}else""===v&&(v=" "),s+="<td>"+v.toHtml().replace(/\r\n|\n|\r/g,"<br/>"),s+="</td>\n";else s+='<td align="right">'+v+"</td>\n",sumFields[k]+=1*v;s+="</tr>\n"}if(s+="</tbody>",addSummary){for(s+="<tfoot><tr>",addLineNumbers&&(s+="<th>Sum</th>"),x=0;x<a.length;x+=1)k=a[x]-1,!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType?s+="<th>&nbsp;</th>":s+='<th align="right">'+sumFields[k].toFixed(CSV.statsCnt[k].fieldDecs)+"</th>\n";s+="</tr></tfoot>\n"}return s+="</table>"}}function csvToTableHeaderValue(CSV,addHeaderIfMissing,addLineNumbers,addSummary,options){var j,k,a,s='<table class="table table-bordered table-hover table-condensed">\n',x=0,v="";if(CSV){for(a=getFldPosArr(CSV),(CSV.isFirstRowHeader||addHeaderIfMissing)&&(s+="<thead><tr><th>Field</th><th>Value</th></tr></thead>"),s+="<tbody>",j=0;j<CSV.table.length;j+=1){for(x=0;x<a.length;x+=1){if(s+="<tr>",0===x&&addLineNumbers&&(s+="<th>Record #</th><th>"+(j+1)+"</th></tr><tr>\n"),s+='<th title="Field #'+((k=a[x]-1)+1)+'">'+(v=k>CSV.arHeaderRow.length?"FIELD"+k:CSV.arHeaderRow[k]).toHtml().replace(/\r\n|\r|\n/g,"<br/>")+"</th>\n",v=doTransformations(v=(k=a[x]-1)>=CSV.table[j].length?" ":CSV.table[j][k],k,CSV),!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType)if(""!==v&&"dateOutFormat"in options&&""!==options.dateOutFormat&&CSV.statsCnt[k]&&"D"==CSV.statsCnt[k].fieldType){try{v=moment(v,CSV.dateformat[k]).format(options.dateOutFormat)}catch(e){}s+="<td>"+v.toHtml().replace(/\r\n|\n|\r/g,"<br/>"),s+="</td>\n"}else""===v&&(v=" "),s+="<td>"+v.toHtml().replace(/\r\n|\n|\r/g,"<br/>")+"</td>\n";else s+='<td align="right">'+v.toFixed(CSV.statsCnt[k].fieldDecs)+"</td>\n";s+="</tr>\n"}s+=""}return s+="</tbody>",s+="</table>"}}function csvToWikiTable(CSV,addHeaderIfMissing,addLineNumbers,addSummary){var j,k,a,s='{| class="wikitable sortable"\n',x=0,v="",sumFields=[];if(CSV){for(a=getFldPosArr(CSV),k=0;k<CSV.maxColumnsFound;k+=1)sumFields.push(0);if(CSV.isFirstRowHeader||addHeaderIfMissing)for(s+="|-\n",addLineNumbers&&(s+="! #\n"),x=0;x<a.length;x+=1)s+="! "+(v=(k=a[x]-1)>CSV.arHeaderRow.length?"FIELD"+k:CSV.arHeaderRow[k]).toHtml().replace(/\r\n|\r|\n/g,"<br/>")+"\n";for(j=0;j<CSV.table.length;j+=1){for(s+="|-\n",addLineNumbers&&(s+="! "+(j+1)+"\n"),x=0;x<a.length;x+=1)v=doTransformations(v=(k=a[x]-1)>=CSV.table[j].length?" ":CSV.table[j][k],k,CSV),x>0&&(s+=" |"),!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType?(""===v&&(v=" "),s+="| "+v.toHtml().replace(/\r\n|\n|\r/g,"<br/>").replace(/\|/g,"<nowiki>|</nowiki>")):(s+="| "+v.toFixed(CSV.statsCnt[k].fieldDecs),sumFields[k]+=1*v);s+="\n"}if(s+="",addSummary)for(s+="|-\n",addLineNumbers&&(s+="! Sum\n"),x=0;x<a.length;x+=1)k=a[x]-1,!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType?s+="! \n":s+="! "+sumFields[k].toFixed(CSV.statsCnt[k].fieldDecs)+"\n";return s+="|}"}}function csvToXml(CSV,topName,rowName){var k,hdr,a,j=0,topLevel=topName||"ROWSET",rowLevel=rowName||"ROW",s='<?xml version="1.0"?>\n<'+topLevel+">\n",x=0,v="",h="";if(CSV){if(a=getFldPosArr(CSV),0===CSV.table.length)return s+"</"+topLevel+">";for(hdr=getCsvHeader(CSV),j=0;j<CSV.table.length;j+=1){for(s+="<"+rowLevel+">\n",x=0;x<a.length;x+=1)v=doTransformations(v=(k=a[x]-1)>=CSV.table[j].length?"":CSV.table[j][k]+"",k,CSV),s+="<"+(h=k>=hdr.length?"FIELD"+k:hdr[k].replace(/[:~\/\\;?$@%=\[\]+='"`|()*\^&<>]/,"-")).replace(/\s+/g,"_")+">"+v.toXml()+"</"+h.replace(/\s+/g,"_")+">\n";s+="</"+rowLevel+">\n"}return s+="</"+topLevel+">"}}function csvToXmlProperties(CSV,topName,rowName,options){var k,hdr,j=0,topLevel=topName||"ROWSET",rowLevel=rowName||"ROW";option=options||{};var a,s='<?xml version="1.0"?>\n<'+topLevel+">\n",x=0,v="";if(CSV){if(a=getFldPosArr(CSV),0===CSV.table.length)return s+"</"+topLevel+">";for(hdr=getCsvHeader(CSV),j=0;j<CSV.table.length;j+=1){for(s+="<"+rowLevel,x=0;x<a.length;x+=1)v=(k=a[x]-1)>=CSV.table[j].length?"":CSV.table[j][k],(!options.skipEmpty||null!=v&&""!==v)&&(v=doTransformations(v,k,CSV),s+=" "+(k>=hdr.length?"FIELD"+k:hdr[k].replace(/[:~\/\\;?$@%=\[\]+='"`|()*\^&<>]/,"-")).replace(/\s+/g,"_")+'="'+(v+"").toXml()+'"');s+="></"+rowLevel+">\n"}return s+="</"+topLevel+">"}}function csvToJSON(CSV,options){var k,kp,hdr,j=0,s="",a=[],x=0,v="",h="",emptyIsNull=!1,fldcnt=0;if(options||(options={}),"lineMode"in options||(options.lineMode=!1),options.isKeyed&&(options.mongoDbMode=!1),CSV){a=getFldPosArr(CSV),hdr=getCsvHeader(CSV);var yep=!1,firstArray=!0;if(0===CSV.table.length)return options.mongoDbMode?"":options.isKeyed?"{}":"[]";if(options.tryToObject){for(j=0;j<hdr.length;j+=1){if(hdr[j].indexOf("/")>=0){yep=!0;break}!isNaN(hdr[j].split("/")[0])&&Number.isInteger(1*hdr[j].split("/")[0])||(firstArray=!1)}if(firstArray&&(yep=!0),yep)return csvToJSONSpecial(CSV,options)}for(options.mongoDbMode||(s="[\n"),j=0;j<CSV.table.length;j+=1){for(options.mongoDbMode||(s+=" "),s+="{",options.mongoDbMode||options.lineMode||(s+="\n"),fldcnt=0,x=0;x<a.length;x+=1)k=a[x]-1,emptyIsNull=document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked,""===(v=k>=CSV.table[j].length?"":CSV.table[j][k])&&options.skipEmpty||(s+=fldcnt>0?","+(options.mongoDbMode||options.lineMode?"":"\n"):"",h=k>=hdr.length||!hdr[k]||""===hdr[k]?"FIELD"+(x+1):hdr[k],options.mongoDbMode||(s+="  "),s+=' "'+h.toJson()+'": ',v=doTransformations(v,k,CSV),!options.forceWrap&&(CSV.statsCnt[k]&&("N"==CSV.statsCnt[k].fieldType||"I"==CSV.statsCnt[k].fieldType||"B"==CSV.statsCnt[k].fieldType)||options.autoNum&&v.isNumeric())?""!==v.trim()?((v=v.toNumber()+"").left(1)==getDecimalChar()&&(v="0"+v),v.left(2)=="-"+getDecimalChar()&&(v="-0"+v.substr(1)),s+=v):s+="null":!options.forceWrap&&CSV.statsCnt[k]&&"L"==CSV.statsCnt[k].fieldType?""!==v.trim()?s+=v.toLocaleLowerCase():s+="null":emptyIsNull&&""===v||options.nullIsNull&&("NULL"==v.toUpperCase()||"\\N"===v)?s+="null":s+='"'+v.toJson()+'"',fldcnt+=1);options.mongoDbMode||options.lineMode||(s+="\n"),s+=" }",j<CSV.table.length-1&&!options.mongoDbMode&&(s+=","),s+="\n"}if(options.mongoDbMode||(s+="]"),!options.mongoDbMode&&options.isKeyed){kp=1,document.getElementById("txtKeyNum")&&(kp=document.getElementById("txtKeyNum").value||"1",(kp=isNaN(kp)?1:+kp)<1&&(kp=1)),kp-=1,a=JSON.parse(s),s="";var newa={},kn=hdr[kp],dups=!1;for(i=0;i<2;i+=1){for(newa={},j=0;j<a.length;j+=1)if(kp>=CSV.table[j].length?keyvalue="":keyvalue=CSV.table[j][kp],keyvalue=doTransformations(keyvalue,kp,CSV),kn in a[j]&&delete a[j][kn],keyvalue in newa){if(0===i){dups=!0;break}newa[keyvalue].push(a[j])}else switch(dups){case!1:newa[keyvalue]=a[j];break;case!0:newa[keyvalue]=[a[j]]}if(0===i&&!dups)break}if(options.lineMode){for(a=[],newaa=Object.keys(newa),j=0;j<newaa.length;j+=1)k=newaa[j],a.push('"'+k.toJson()+'":'+JSON.stringify(newa[k]));return"{\n"+a.join(",\n")+"\n}"}return JSON.stringify(newa,null,3)}return s}}function csv2jsonObj(hdr,v,options){var t=[],p=[],o={},firstArray=!0;function delete_null_properties(test,recurse){for(var i in test)null===test[i]||""===test[i]?delete test[i]:recurse&&"object"==typeof test[i]&&delete_null_properties(test[i],recurse);if(_.isArray(test))for(i=0;i<test.length;i+=1)void 0===test[i]&&(test.splice(i,1),i-=1)}for(j=0;j<hdr.length;j+=1)!isNaN(hdr[j].split("/")[0])&&Number.isInteger(1*hdr[j].split("/")[0])||(firstArray=!1);for(firstArray&&(o=[]),j=0;j<hdr.length;j+=1)for(p=hdr[j].split("/"),s="o",k=0;k<p.length;k+=1)t=[],s=s+'["'+p[k].replace("\\","\\\\").replace('"','\\"')+'"]',k<p.length-1&&!isNaN(p[k+1])&&Number.isInteger(1*p[k+1])?eval("if (typeof "+s+'=="undefined")'+s+"=[]"):k<p.length-1&&eval("if (typeof "+s+'=="undefined")'+s+"={}"),k==p.length-1&&eval(s+"=v[j]");options.skipEmpty&&delete_null_properties(o,!0);var spacing=options.mongoDbMode||options.lineMode?0:3;return JSON.stringify(o,null,spacing)}function csvToJSONSpecial(CSV,options){var k,hdr,kp,keyvalue,j=0,s="[\n",a=[],x=0,v="",cur="",emptyIsNull=!1;if(options.mongoDbMode&&(s=""),CSV){if(a=getFldPosArr(CSV),0===CSV.table.length)return options.mongoDbMode?"":s+"]";hdr=getCsvHeader(CSV);var newhdr=[];for(j=0;j<a.length;j+=1)newhdr.push(hdr[a[j]-1]);for(j=0;j<CSV.table.length;j+=1){for(s+=" ",cur="[",x=0;x<a.length;x+=1)k=a[x]-1,emptyIsNull=document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked,v=doTransformations(v=k>=CSV.table[j].length?"":CSV.table[j][k],k,CSV),!options.forceWrap&&(CSV.statsCnt[k]&&("N"==CSV.statsCnt[k].fieldType||"I"==CSV.statsCnt[k].fieldType||"B"==CSV.statsCnt[k].fieldType)||options.autoNum&&v.isNumeric())?""!==v.rtrim()?((v=v.toNumber()+"").left(1)==getDecimalChar()&&(v="0"+v),v.left(2)=="-"+getDecimalChar()&&(v="-0"+v.substr(1)),cur+=v):cur+="null":!options.forceWrap&&CSV.statsCnt[k]&&"L"==CSV.statsCnt[k].fieldType?cur+=""!==v?v.toLocaleLowerCase():"null":emptyIsNull&&""===v||options.nullIsNull&&("NULL"==v.toUpperCase()||"\\N"===v)?cur+="null":cur+='"'+v.toJson()+'"',cur+=x<a.length-1?",":"";cur+="]",s+=csv2jsonObj(newhdr,JSON.parse(cur),options),j<CSV.table.length-1&&!options.mongoDbMode&&(s+=","),s+="\n"}if(options.mongoDbMode||(s+="]"),!options.mongoDbMode&&options.isKeyed){kp=1,document.getElementById("txtKeyNum")&&(kp=document.getElementById("txtKeyNum").value||"1",(kp=isNaN(kp)?1:+kp)<1&&(kp=1)),kp-=1,a=JSON.parse(s),s="";var newa={},kn=hdr[kp],dups=!1;for(i=0;i<2;i+=1){for(newa={},j=0;j<a.length;j+=1)if(keyvalue=doTransformations(keyvalue=kp>=CSV.table[j].length?"":CSV.table[j][kp],kp,CSV),kn in a[j]&&delete a[j][kn],keyvalue in newa){if(0===i){dups=!0;break}newa[keyvalue].push(a[j])}else switch(dups){case!1:newa[keyvalue]=a[j];break;case!0:newa[keyvalue]=[a[j]]}if(0===i&&!dups)break}if(options.lineMode){a=[];var newaa=Object.keys(newa);for(j=0;j<newaa.length;j+=1)k=newaa[j],a.push('"'+k.toJson()+'":'+JSON.stringify(newa[k]));return"{\n"+a.join(",\n")+"\n}"}return JSON.stringify(newa,null,3)}return s}}function csvToJSONArray(CSV,options){var k,hdr,a,j=0,s="[\n",x=0,v="",t="{\n",emptyIsNull=!1;if(CSV){if(a=getFldPosArr(CSV),0===CSV.table.length)return s+"]";if(hdr=getCsvHeader(CSV),options.useFieldsData){for(t+='  "'+(options.fldPropName||"fields")+'": [',x=0;x<a.length;x+=1)x>0&&(t+=", "),t+=((k=a[x]-1)>=hdr.length?"FIELD"+k:hdr[k]).enclose('"');t+="],\n",t+='  "'+(options.dataPropName||"data")+'": '}for(j=0;j<CSV.table.length;j+=1){for(a.length>1&&(s+="  ["),x=0;x<a.length;x+=1)k=a[x]-1,emptyIsNull=document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked,v=doTransformations(v=k>=CSV.table[j].length?"":CSV.table[j][k],k,CSV),options.forceWrap||!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType&&"B"!=CSV.statsCnt[k].fieldType?!options.forceWrap&&CSV.statsCnt[k]&&"L"==CSV.statsCnt[k].fieldType?""!==v.trim()?s+=v.toLocaleLowerCase():s+="null":emptyIsNull&&""===v||options.nullIsNull&&("NULL"==v.toUpperCase()||"\\N"===v)?s+="null":s+='"'+v.toJson()+'"':""!==v.trim()?((v=v.toNumber()+"").left(1)==getDecimalChar()&&(v="0"+v),v.left(2)=="-"+getDecimalChar()&&(v="-0"+v.substr(1)),s+=v):s+="null",s+=x<a.length-1?",":"";a.length>1&&(s+="  ]"),j<CSV.table.length-1&&(s+=","),s+="\n"}return s+="]",options.useFieldsData&&(s=t+s+"\n}"),s}}function csvToJSONColumnArray(CSV,options){var k,hdr,a,j=0,s="{\n",x=0,v="",emptyIsNull=!1;if(CSV){if(a=getFldPosArr(CSV),0===CSV.table.length)return s+"]";for(hdr=getCsvHeader(CSV),x=0;x<a.length;x+=1){k=a[x]-1,emptyIsNull=document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked,s+='   "'+(x>=hdr.length?"FIELD"+k:hdr[k])+'":[';var crow=0;for(j=0;j<CSV.table.length;j+=1)s+=(crow+=1)>1?",":"",v=doTransformations(v=x>=CSV.table[j].length?"":CSV.table[j][k],k,CSV),options.forceWrap||!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType&&"B"!=CSV.statsCnt[k].fieldType?!options.forceWrap&&CSV.statsCnt[k]&&"L"==CSV.statsCnt[k].fieldType?""!==v.trim()?s+=v.toLocaleLowerCase():s+="null":emptyIsNull&&""===v||options.nullIsNull&&("NULL"==v.toUpperCase()||"\\N"===v)?s+="null":s+='"'+v.toJson()+'"':""!==v.trim()?((v=v.toNumber()+"").left(1)==getDecimalChar()&&(v="0"+v),v.left(2)=="-"+getDecimalChar()&&(v="-0"+v.substr(1)),s+=v):s+="null";s+="]",x<a.length-1&&(s+=","),s+="\n"}return s+="}"}}function jsonToCsv(objArray,delimiter,bIncludeHeaders,bQuotes,noMultiLines){var array,str="",line="",i,j,index,value,columns=[];try{array="object"!=typeof objArray?JSON.parse(objArray):objArray}catch(e){if("["!==objArray.charAt(0)&&"{"!==objArray.charAt(0))throw e;array=eval("array="+objArray)}if(!_.isObject(array)||null===array||_.isEmpty(array))return line="",str="",bIncludeHeaders&&(value="Field1",line=bQuotes?'"'+value.replace(/"/g,'""')+'"'+delimiter:value.toCsv(delimiter,'"'),str+=line+"\n"),array&&_.isObject(array)&&_.isEmpty(array)||(value=null===array?"":array+"",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),str+=(bQuotes?'"':"")+(""+value).toCsv(delimiter,'"')+(bQuotes?'"':"")+"\n"),str;var depth=getJsonLevel(array);if(2==depth&&_.isArray(array)){for(bIncludeHeaders&&(value="Field1",line+=bQuotes?'"'+value.replace(/"/g,'""')+'"'+delimiter:value.toCsv(delimiter,'"'),str+=line+"\n"),i=0;i<array.length;i+=1){var line="";value=array[i],null===value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+=(bQuotes?'"':"")+(""+value).toCsv(delimiter,'"')+(bQuotes?'"':""),str+=line+"\n"}return str}if(3==depth&&!_.isArray(array)&&_.every(_.values(array),_.isArray)&&(array=objTransform(array)),3==depth&&_.isArray(array)&&_.every(_.values(array),_.isArray)){if(bIncludeHeaders){var head=array[0];for(index in array[0])value="Field"+(1*index+1),columns.push(value),line+=bQuotes?'"'+value.replace(/"/g,'""')+'"'+delimiter:value.toCsv(delimiter,'"')+delimiter;line=line.slice(0,-1),str+=line+"\n"}else for(index in array[0])columns.push(index);for(i=0;i<array.length;i+=1){var line="";for(j=0;j<columns.length;j+=1)value=array[i][j],null===value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+=(""+value).toCsv(delimiter,'"','"',bQuotes)+delimiter;line=line.slice(0,-1*delimiter.length),str+=line+"\n"}return str}for(;_.isObject(array)&&!_.isArray(array)&&1==_.keys(array).length&&(_.isObject(_.values(array)[0])||_.isArray(_.values(array)[0])&&_.isObject(_.values(array)[0][0]));)array=_.values(array)[0];for(!1===_.isArray(array)&&!0===_.isObject(array)&&(array=JSON.flatten(array),array=JSON.parse("["+JSON.stringify(array)+"]")),i=0;i<array.length;i+=1)for(j=0;j<columns.length;j+=1)value=array[i][columns[j]],!1===_.isArray(value)&&!0===_.isObject(value)&&columns[j]in array[i]&&(array[i][columns[j]]=JSON.flatten(value));if(_.isObject(array[0])&&_.every(_.values(array),_.isObject))if(bIncludeHeaders){var head=array[0];if(bQuotes)for(index in array[0])value=index+"",columns.push(value),line+='"'+value.replace(/"/g,'""')+'"'+delimiter;else for(index in array[0])value=index+"",columns.push(value),line+=value.toCsv(delimiter,'"')+delimiter;line=line.slice(0,-1),str+=line+"\n"}else for(index in array[0])columns.push(index);if(0===columns.length&&!0===_.isArray(array)){for(str="",bIncludeHeaders&&(value="Field1",line+=bQuotes?'"'+value.replace(/"/g,'""')+'"'+delimiter:value.toCsv(delimiter,'"'),str+=line+"\n"),i=0;i<array.length;i+=1){var line="";value=array[i],null===value?value="":value+="","[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(array[i]).slice(0,-1)),noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+=(bQuotes?'"':"")+(""+value).toCsv(delimiter,'"')+(bQuotes?'"':""),str+=line+"\n"}return str}for(i=0;i<array.length;i+=1){var line="";if(bQuotes)for(j=0;j<columns.length;j+=1)value=array[i][columns[j]],"[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(array[i][columns[j]]).slice(0,-1)),null===value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+='"'+value.replace(/"/g,'""')+'"'+delimiter;else for(j=0;j<columns.length;j+=1)value=array[i][columns[j]],"[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(array[i][columns[j]]).slice(0,-1)),null===value?value="":value+="",noMultiLines&&(value=value.replace(/\r\n|\r|\n/g," ")),line+=(""+value).toCsv(delimiter,'"')+delimiter;line=line.slice(0,-1*delimiter.length),str+=line+"\n"}return str}function csvToMarkdown(CSV,options){var k,a,j=0,s="",x=0,v="";if(CSV){a=getFldPosArr(CSV);var centerAdjust=!1,rightAdjust=!1;options||(options={}),void 0!==options.addsep&&null!==options.addsep||(options.addsep=" "),!options.addTable||""!==options.addsep&&" "!==options.addsep||(options.addsep="|"),options.addsep="|";var hdr=getCsvHeader(CSV)||[],stats=getCsvColLength(CSV)||[],ladj=0,t="";for(x=0;x<a.length;x+=1)k=a[x]-1,CSV.isFirstRowHeader&&hdr[k]&&hdr[k].length>stats[k]&&(stats[k]=hdr[k].length),stats[k]+1;for(options.addLineNumbers&&(""+CSV.table.length).length+3,s+=options.addsep,options.addLineNumbers&&(s+=" # ".rpad((""+CSV.table.length).length," ",!1)+options.addsep),x=0;x<a.length;x+=1)ladj=0,k=a[x]-1,x>0&&(s+=options.addsep),(v=k>=hdr.length||!CSV.isFirstRowHeader?"":hdr[k].replace(/\r\n|\r|\n/g," ")).indexOf("|")>-1&&(ladj+=5*((v=v.replace(/\|/g,"&#124;")).split("&#124;").length-1)),stats[k]+ladj<3&&(ladj+=3-(stats[k]+ladj)),s+=v.rpad(stats[k]+ladj);for(s+=options.addsep+"\n",options.addLineNumbers&&(s+=options.addsep+"---".rpad((""+CSV.table.length).length," ",!1)),s+=options.addsep,x=0;x<a.length;x+=1)k=a[x]-1,rightAdjust=!1,centerAdjust=!1,document.getElementById("chkrjust"+(k+1))&&document.getElementById("chkrjust"+(k+1)).checked&&(rightAdjust=!0),document.getElementById("chkcjust"+(k+1))&&document.getElementById("chkcjust"+(k+1)).checked&&(centerAdjust=!0),x>0&&(s+=options.addsep),t="---".rpad(k<stats.length?stats[k]:hdr[k].length,"-",!1),centerAdjust?t=":"+t.substr(0,t.length-2)+":":rightAdjust&&(t=t.substr(0,t.length-1)+":"),s+=t;s+=options.addsep+"\n";var crow=0;for(j=0;j<CSV.table.length;j+=1){for(crow+=1,s+=options.addsep,options.addLineNumbers&&(s+=(""+crow).rpad(Math.max(3,(""+CSV.table.length).length)," ",!1)+options.addsep),x=0;x<a.length;x+=1)ladj=0,k=a[x]-1,x>0&&(s+=options.addsep),v=k>=CSV.table[j].length?"":CSV.table[j][k],!options.nullIsEmpty||"NULL"!=v.toUpperCase()&&"\\N"!==v||(v=""),rightAdjust=!1,centerAdjust=!1,(v=doTransformations(v,k,CSV)).indexOf("|")>-1&&(ladj+=5*((v=v.replace(/\|/g,"&#124;")).split("&#124;").length-1)),document.getElementById("chkrjust"+(k+1))&&document.getElementById("chkrjust"+(k+1)).checked&&(rightAdjust=!0),document.getElementById("chkcjust"+(k+1))&&document.getElementById("chkcjust"+(k+1)).checked&&(centerAdjust=!0),v=centerAdjust?v.replace(/\r\n|\r|\n/g," ").cjust(stats[k]):rightAdjust?v.replace(/\r\n|\r|\n/g," ").rjust(stats[k]):v.replace(/\r\n|\r|\n/g," "),stats[k]+ladj<3&&(ladj+=3-(stats[k]+ladj)),s+=v.rpad(stats[k]+ladj," ",!1);(options.addTable||options.addMarkdown)&&(s+=options.addsep),s+="\n"}return s}}function csvToFixed(CSV,options){var k,j=0,s="",a=[],x=0,v="",ruler="",ruler10="";if(CSV){a=getFldPosArr(CSV);var centerAdjust=!1,rightAdjust=!1;if(options||(options={}),void 0!==options.addsep&&null!==options.addsep||(options.addsep=" "),!options.addTable||""!==options.addsep&&" "!==options.addsep||(options.addsep="|"),0===CSV.table.length)return s;var hdr=getCsvHeader(CSV)||[],stats=getCsvColLength(CSV)||[],linewidth=0,ladj=0;if("pad"in options&&options.pad||(options.pad=" "),options.addTable){for(x=0;x<a.length;x+=1)k=a[x]-1,CSV.isFirstRowHeader&&hdr[k]&&hdr[k].length>stats[k]&&(stats[k]=hdr[k].length),linewidth+=stats[k]+1;if(options.addLineNumbers&&(linewidth+=(""+CSV.table.length).length+1),s+="+".rpad(linewidth,"-")+"+\n",CSV.isFirstRowHeader){for(s+=options.addsep,options.addLineNumbers&&(s+="#".rpad((""+CSV.table.length).length)+options.addsep),x=0;x<a.length;x+=1)ladj=0,k=a[x]-1,x>0&&(s+=options.addsep),s+=(v=k>=hdr.length||!CSV.isFirstRowHeader?"":hdr[k].replace(/\r\n|\r|\n/g," ")).rpad(stats[k]+ladj,options.pad);s+=options.addsep+"\n",s+="+".rpad(linewidth,"-")+"+\n"}}var crow=0;for(j=0;j<CSV.table.length;j+=1){for(crow+=1,options.addTable&&(s+=options.addsep),options.addLineNumbers&&(s+=(""+crow).rpad((""+CSV.table.length).length)+options.addsep),x=0;x<a.length;x+=1)ladj=0,k=a[x]-1,x>0&&(s+=options.addsep),v=k>=CSV.table[j].length?"":CSV.table[j][k],!options.nullIsEmpty||"NULL"!=v.toUpperCase()&&"\\N"!==v||(v=""),rightAdjust=!1,centerAdjust=!1,v=doTransformations(v,k,CSV),document.getElementById("chkrjust"+(k+1))&&document.getElementById("chkrjust"+(k+1)).checked&&(rightAdjust=!0),document.getElementById("chkcjust"+(k+1))&&document.getElementById("chkcjust"+(k+1)).checked&&(centerAdjust=!0),s+=(v=centerAdjust?v.replace(/\r\n|\r|\n/g," ").cjust(stats[k]):rightAdjust?v.replace(/\r\n|\r|\n/g," ").rjust(stats[k]):v.replace(/\r\n|\r|\n/g," ")).rpad(stats[k]+ladj,options.pad);var z;if(!options.addTable&&options.addRuler&&1==crow){for(z=1;z<=s.length;z+=1)ruler+=(""+z).right(1);if(s.length>=10){for(z=1,x=10;x<=s.length;x+=10,z+=1)ruler10+="         "+(""+z).right(1);ruler=(ruler10=ruler10.rpad(ruler.length))+"\n"+ruler}}options.addTable&&(s+=options.addsep),s+="\n",options.addTable&&options.addLineSep&&!options.addMardown&&(s+="+".rpad(linewidth,"-")+"+\n")}return!options.addTable||options.addLineSep||options.addMardown||(s+="+".rpad(linewidth,"-")+"+\n"),options.addRuler&&!options.addTable&&(a=ruler.split("\n"),s=ruler+"\n"+a[a.length-1].replace(/[12346789]/g,"-").replace(/0/g,"|").replace(/5/g,"+")+"\n"+s),s}}function fixedToCsv(input,fieldDef,delimiter,bIncludeHeaders,bQuotes,nowrap,notrim){var i,j,fa=fieldDef.split("|")||[],str="",line="",fld=[],header="",array=input.split(/\n|\r|\r\n/gim);if(""===array[array.length-1]&&array.pop(),bIncludeHeaders){for(i=0;i<fa.length;i+=1)header=(fld=fa[i].split(",")).length>2?fld[2]:"F"+(i+1),str+=bQuotes?'"'+header.replace(/"/g,'""')+'"'+delimiter:header.toCsv(delimiter,'"')+delimiter;str=str.slice(0,-1*delimiter.length)+"\n"}var p=0,len=0;for(i=0;i<array.length;i+=1)if(line="",""!==array[i]){for(j=0;j<fa.length;j+=1)p=(fld=fa[j].split(",")||[]).length>0?fld[0]-1:0,len=fld.length>1?fld[1]:0,fld.length>2?fld[2]:"f"+(j+1),value=notrim?array[i].substr(p,len):array[i].substr(p,len).trim(),null===value?value="":value+="",line+=bQuotes?'"'+(""+value).replace(/"/g,'""')+'"'+delimiter:nowrap?""+value+delimiter:(""+value).toCsv(delimiter,'"')+delimiter;str+=(line=line.slice(0,-1*delimiter.length))+"\n"}return str}function csvToMulti(CSV,sep,addFieldName,addFieldNameSep,addLineAfterField,addXSpaces,noMultiLines,bQuotes,csvFormat,nullIsNull){var k,a,j=0,s="",x=0,v="",fheader="";if(addXSpaces=addXSpaces||"0",isNaN("0"+addXSpaces)&&(addXSpaces="0"),a=getFldPosArr(CSV),CSV){if(addFieldNameSep=addFieldNameSep||"",0===CSV.table.length)return s;for(getCsvHeader(CSV),j=0;j<CSV.table.length;j+=1){for(x=0;x<a.length;x+=1)fheader="",(k=a[x]-1)>=CSV.table[j].length?v="":(v=CSV.table[j][k]+"")&&noMultiLines&&(v=v.replace(/\r\n|\r|\n/g," ")),v&&nullIsNull&&(v=v.replace(/^null$/gim,"")),v=doTransformations(v,k,CSV),csvFormat&&(v=v.toCsv(sep,CSV.outputQuote,CSV.outputQuote,bQuotes)),addFieldName&&(fheader=csvFormat?k>=CSV.arHeaderRow.length?("".rpad(addXSpaces)+"Field-"+(k+1)).toCsv(sep,CSV.outputQuote,CSV.outputQuote,bQuotes)+addFieldNameSep:("".rpad(addXSpaces)+CSV.arHeaderRow[k].replace(/\r\n|\r|\n/g," ")).toCsv(sep,CSV.outputQuote,CSV.outputQuote,bQuotes)+addFieldNameSep:k>=CSV.arHeaderRow.length?"".rpad(addXSpaces)+"Field-"+(k+1)+addFieldNameSep:"".rpad(addXSpaces)+CSV.arHeaderRow[k].replace(/\r\n|\r|\n/g," ")+addFieldNameSep),s+=fheader+v+"\n",addLineAfterField&&(s+="\n");csvFormat||(s+=sep+"\n")}return s}}function csvToKml(CSV,nameCol,descCol,latCol,longCol,altCol,descCol2){var k,hdr,j=0,desc2="",altitude="",s='<?xml version="1.0" encoding="UTF-8"?>\n';if(s+='<kml xmlns="http://earth.google.com/kml/2.0">\n',s+="<Document>\n",CSV){if(0===CSV.table.length)return s+"</Document></kml>";for(hdr=getCsvHeader(CSV),(""===descCol2.trim()||isNaN(descCol2)||1*descCol2<1||1*descCol2>CSV.table[0].length)&&(descCol2=""),j=0;j<CSV.table.length;j+=1){for(s+="<Placemark>\n",desc2="",k=0;k<CSV.table[j].length&&!(k>=hdr.length);k+=1)if((isNaN(latCol)||k!=latCol-1)&&(isNaN(longCol)||k!=longCol-1)&&(isNaN(altCol)||k!=altCol-1)){if(isNaN(nameCol)||k!=nameCol-1){if(isNaN(descCol)||k!=descCol-1)continue;hdr[k]="description",""!==descCol2&&(desc2=" "+CSV.table[j][descCol2-1])}else hdr[k]="name";v=CSV.table[j][k]?CSV.table[j][k]:"",v=doTransformations(v,k,CSV),s+="<"+hdr[k]+">"+v.toHtml()+desc2.toHtml()+"</"+hdr[k]+">\n"}!isNaN(latCol)&&!isNaN(longCol)&&latCol.length>0&&longCol.length>0&&1*latCol<=CSV.table[j].length&&1*longCol<=CSV.table[j].length&&CSV.table[j][1*latCol-1]&&CSV.table[j][1*longCol-1]&&(altitude=""!==altCol&&!isNaN(altCol)&&1*altCol<=CSV.table[j].length&&CSV.table[j][1*altCol-1]?doTransformations(CSV.table[j][1*altCol-1],1*altCol-1,CSV):"0",s+="<Point><coordinates>",s+=doTransformations(CSV.table[j][longCol-1],longCol-1,CSV)+","+doTransformations(CSV.table[j][latCol-1],latCol-1,CSV)+","+altitude,s+="</coordinates></Point>\n"),s+="</Placemark>\n"}return s+="</Document>\n</kml>"}}function csvToCsv(CSV,options){if(CSV){if(0===CSV.table.length)return"";options||(options={});var k,hdr,a,delimiter=options.delimiter,headingSpecified=options.headingSpecified,excelForceMode=options.excelForceMode,defaultHeader=options.defaultHeader,noMultiLines=options.noMultiLines,bQuotes=options.bQuotes,nullIsNull=options.nullIsNull,neverEnclose=options.neverEnclose,j=0,s="",x=0;if(a=getFldPosArr(CSV),headingSpecified||defaultHeader){for(hdr=getCsvHeader(CSV),x=0;x<a.length;x+=1)x>0&&(s+=delimiter),s+=((j=a[x]-1)>=hdr.length?"":hdr[j]).toCsv(delimiter,CSV.outputQuote,CSV.outputQuote);""!==s&&(s+="\n")}for(j=0;j<CSV.table.length;j+=1){for(x=0;x<a.length;x+=1){if(k=a[x]-1,(v=CSV.table[j][k]?CSV.table[j][k]:"")&&nullIsNull&&(v=v.replace(/^null$/gim,"")),v&&noMultiLines&&(v=v.replace(/\r\n|\r|\n/g," ")),""!==(v=doTransformations(v,k,CSV))&&"dateOutFormat"in options&&""!==options.dateOutFormat&&CSV.statsCnt[k]&&"D"==CSV.statsCnt[k].fieldType){var vv=v;try{var v=moment(v,CSV.dateformat[k]).format(options.dateOutFormat)}catch(e){v=vv}}excelForceMode&&""!==v?v.indexOf(",")<0&&v.indexOf("\n")<0&&v.indexOf("\r")<0?s+="="+v.toCsv(delimiter,CSV.outputQuote,CSV.outputQuote,!0):s+=("="+v.toCsv(delimiter,CSV.outputQuote,CSV.outputQuote,!0)).toCsv(delimiter,CSV.outputQuote,CSV.outputQuote,!0):bQuotes||!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType?s+=neverEnclose?v.toCsv(delimiter,"","",!1):v.toCsv(delimiter,CSV.outputQuote,CSV.outputQuote,bQuotes):s+=v||"",s+=x<a.length-1?delimiter:""}s+="\n"}return s}}function transposeCsv(CSV,delimiter,headingSpecified,excelForceMode,defaultHeader,noMultiLines,bQuotes){if(CSV){if(0===CSV.table.length)return"";var k,a,v,j=0,s="",x=0;for(a=getFldPosArr(CSV),x=0;x<a.length;x+=1){for((headingSpecified||defaultHeader)&&(s+=getCsvHeader(CSV)[j=a[x]-1].toCsv(delimiter,CSV.outputQuote),CSV.table.length>0&&(s+=delimiter)),j=0;j<CSV.table.length;j+=1)k=a[x]-1,(v=CSV.table[j][k]?CSV.table[j][k]:"")&&noMultiLines&&(v=v.replace(/\r\n|\r|\n/g," ")),v=doTransformations(v,k,CSV),excelForceMode&&""!==v?v.indexOf(",")<0?s+="="+v.toCsv(delimiter,CSV.outputQuote,CSV.outputQuote,excelForceMode):s+='"="'+v.toCsv(delimiter,CSV.outputQuote,CSV.outputQuote,excelForceMode)+'""':bQuotes||!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType?s+=v.toCsv(delimiter,CSV.outputQuote,CSV.outputQuote,bQuotes):s+=v||"",s+=j<CSV.table.length-1?delimiter:"";s+="\n"}return s}}function getCsvColLength(CSV){var j=0,k=0,n=0,d=0,stats=[];if(CSV){if(0===CSV.table.length)return stats;for(k=0;k<CSV.maxColumnsFound;k+=1)stats.push(0);for(j=0;j<CSV.table.length;j+=1)for(k=0;k<stats.length;k+=1)if(!(k>=CSV.table[j].length)){if(CSV.table[j][k].length>stats[k]&&(stats[k]=CSV.table[j][k].length),document.getElementById("fdecimals"+(k+1)))if(d=document.getElementById("fdecimals"+(k+1)).value,!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType&&"B"!=CSV.statsCnt[k].fieldType){if(""!==d.trim()&&CSV.statsCnt[k]&&""!==CSV.table[j][k].trim()&&("D"==CSV.statsCnt[k].fieldType||(CSV.statsCnt[k].dateCnt-CSV.statsCnt[k].emptyCnt)/CSV.dataRowsFound>=.9))try{(n=moment(CSV.table[j][k],CSV.dateformat[k]).format(d).length)>stats[k]&&(stats[k]=n)}catch(e){}}else isNaN(d)?d=0:d*=1,""!==CSV.table[j][k].trim()&&(n=(CSV.table[j][k].toNumber().toFixed(d)+"").length)>stats[k]&&(stats[k]=n);document.getElementById("fpadsize"+(k+1))&&(n=document.getElementById("fpadsize"+(k+1)).value,isNaN(n)?n=0:n*=1,n>0&&(stats[k]=n))}return stats}}function isSqlKeywords(){return["ACTION","ADD","AFTER","ALL","ALTER","ANALYZE","AND","AS","ASC","ATTACH","AUTOINCREMENT","BEFORE","BEGIN","BETWEEN","BY","CASCADE","CASE","CAST","CHECK","COLLATE","COLUMN","COMMIT","CONFLICT","CONSTRAINT","CREATE","CROSS","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","DATABASE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DETACH","DISTINCT","DROP","EACH","ELSE","END","ESCAPE","EXCEPT","EXCLUSIVE","EXISTS","EXPLAIN","FAIL","FOR","FOREIGN","FROM","FULL","GLOB","GROUP","HAVING","IF","IGNORE","IMMEDIATE","IN","INDEX","INDEXED","INITIALLY","INNER","INSERT","INSTEAD","INTERSECT","INTO","IS","ISNULL","JOIN","KEY","LEFT","LIKE","LIMIT","MATCH","NATURAL","NO","NOT","NOTNULL","NULL","OF","OFFSET","ON","OR","ORDER","OUTER","PLAN","PRAGMA","PRIMARY","QUERY","RAISE","RECURSIVE","REFERENCES","REGEXP","REINDEX","RELEASE","RENAME","REPLACE","RESTRICT","RIGHT","ROLLBACK","ROW","SAVEPOINT","SELECT","SET","SUM","SYSDATE","TABLE","TEMP","TEMPORARY","THEN","TO","TRANSACTION","TRIGGER","UNION","UNIQUE","UPDATE","USING","VACUUM","VALUES","VIEW","VIRTUAL","WHEN","WHERE","WITH","WITHOUT"]}function csvToSql(CSV,operation,options){var k,i,n,m,d,row,hdr,j=0,cnt=0,s="",tp="",v="",tem="",incl=[],usrhdr=[],fsize=[],fdec=[],freq=[],temValuesSet=!1,where="",keys=[],keycnt=0,fldpad=0,useNullForEmpty=!1,batch=0,includeCnt=0,includeNotKeyCnt=0;if(CSV){operation=operation||"I",options.newlines=options.newlines||!1,"dualNeeded"in options||(options.dualNeeded=!1),"batchSize"in options&&""!==options.batchSize.trim()&&!isNaN(options.batchSize)||(options.batchSize=Number.MAX_VALUE),"useTerseValuesSize"in options&&""!==options.useTerseValuesSize.trim()&&!isNaN(options.useTerseValuesSize)||(options.useTerseValuesSize=Number.MAX_VALUE),options.useTerseValues||(options.useTerseValuesSize=""),hdr=getCsvHeader(CSV);for(k=0;k<hdr.length;k+=1)usrhdr[k]=hdr[k].replace(/\s+/g,"_"),usrhdr[k].length>fldpad&&(fldpad=usrhdr[k].length),keys[k]=!1,fsize[k]=fdec[k]="",document.getElementById("fkey"+(k+1))&&document.getElementById("fkey"+(k+1)).checked&&(keycnt+=1,keys[k]=!0),document.getElementById("fname"+(k+1))&&(usrhdr[k]=document.getElementById("fname"+(k+1)).value.replace(/\s+/g,"_")),document.getElementById("freq"+(k+1))&&(freq[k]=document.getElementById("freq"+(k+1)).checked),document.getElementById("fsize"+(k+1))?(fsize[k]=document.getElementById("fsize"+(k+1)).value.trim(),isNaN(fsize[k])?fsize[k]=30:fsize[k]*=1,fsize[k]<1&&(fsize[k]="")):fsize[k]=30,document.getElementById("fdec"+(k+1))&&(fdec[k]=document.getElementById("fdec"+(k+1)).value.trim(),isNaN(fdec[k])?fdec[k]="":(fdec[k]*=1,fdec[k]<0&&(fdec[k]=""))),document.getElementById("finc"+(k+1))?document.getElementById("finc"+(k+1)).checked?(incl[k]=!0,includeCnt+=1):incl[k]=!1:(incl[k]=!0,includeCnt+=1);if(0===hdr.length)return"";if(0===includeCnt&&"S"==operation)return"";if(options.tableName.indexOf(" ")>0&&"["!=options.tableName.charAt(0)&&"`"!=options.tableName.charAt(0)&&(options.tableName='"'+options.tableName+'"'),options.dropTable&&(s+="DROP "+("S"===operation?"VIEW ":"TABLE ")+(options.dropExists?"IF EXISTS ":"")+options.tableName+";\n"),options.createTable&&"S"!=operation){var savnewlines=options.newlines;for(options.newlines=!0,s+="CREATE TABLE "+(options.createNotExists?"IF NOT EXISTS ":"")+options.tableName+"(",options.newlines&&(s+="\n"),n=k=0;k<hdr.length;k+=1,n+=1){switch(options.newlines&&n>0&&(s+="\n"),s+=n>0?"  ,":"   ",s+=usrhdr[k].rpad(fldpad),tp="VC",k<CSV.statsCnt.length&&(tp=CSV.statsCnt[k].fieldType),document.getElementById("ftype"+(k+1))&&(tp=document.getElementById("ftype"+(k+1)).value),tp){case"B":s+=" BIT ";break;case"L":s+=" BOOLEAN ";break;case"NR":case"N":s+="N"==tp?" NUMERIC":" NUMBER",CSV.statsCnt.length>0?(m=CSV.statsCnt[k].fieldPrec+CSV.statsCnt[k].fieldDecs,d=CSV.statsCnt[k].fieldDecs):(m=0,d=fdec[k]?fdec[k]:0),fsize[k]&&fsize[k]>m&&(m=fsize[k]),s+=""!==m?"("+m+","+d+")":" ";break;case"BI":s+=" BIGINT ";break;case"IT":s+=" INT ";break;case"I":s+=" INTEGER ";break;case"M":s+="MONEY";break;case"S":s+=" SERIAL ";break;case"D":s+=" DATE ";break;case"DT":s+=" DATETIME ";break;case"TX":s+=" TEXT ";break;case"NVC":s+=" NVARCHAR"+(fsize[k]?"("+fsize[k]+")":"");break;case"VC":s+=" VARCHAR"+(fsize[k]?"("+fsize[k]+")":"");break;case"VCC":s+=" VARCHAR2"+(fsize[k]?"("+fsize[k]+")":"");break;case"NC":s+=" NCHAR"+(fsize[k]?"("+fsize[k]+")":"");break;default:s+=" CHAR"+(fsize[k]?"("+fsize[k]+")":"")}freq[k]&&(s+=" NOT NULL"),keys[k]&&1==keycnt&&(s+=" PRIMARY KEY","N"!=tp&&"NR"!=tp&&"I"!=tp&&"IT"!=tp&&"BI"!=tp||document.getElementById("selAutoIncrement")&&(s+=" "+document.getElementById("selAutoIncrement").value))}if(keycnt>1){for(options.newlines&&(s+="\n"),s+="  ,PRIMARY KEY(",x=0;x<keys.length;x+=1)keys[x]&&(s+=(x>0?",":"")+usrhdr[x]);s+=")"}options.newlines&&(s+="\n"),s+=");\n",options.newlines=savnewlines}else if(options.createTable&&"S"===operation){for(s+="CREATE ",""!==options.insertAfterText.trim()&&(s+=" "+options.insertAfterText.trim()),s+="VIEW "+(options.createNotExists?"IF NOT EXISTS ":"")+options.tableName+"(",options.newlines&&(s+="\n"),n=k=0;k<hdr.length;k+=1)incl[k]&&(n>0&&(s+=","),s+=usrhdr[k],options.newlines&&(s+="\n"),n+=1);s+=") AS\n"}if(0===includeCnt)return s;switch(operation){case"I":for(cnt=row=0,j=0;j<(CSV.table.length?CSV.table.length:1);j+=1){if(cnt+=1,1==(row+=1)||!options.useTerseValues||cnt>1*options.useTerseValuesSize){for(cnt=1,s+=options.useReplace?"REPLACE":"INSERT",""!==options.insertAfterText.trim()&&(s+=" "+options.insertAfterText.trim()),s+=" INTO "+options.tableName+"(",options.newlines&&(s+="\n"),n=k=0;k<hdr.length;k+=1)incl[k]&&(n>0&&(s+=","),s+=usrhdr[k],options.newlines&&(s+="\n"),n+=1);if(s+=") VALUES"+(options.useTerseValues?"\n":"")+" (",0===CSV.table.length){for(n=k=0;k<hdr.length;k+=1)incl[k]&&(n>0&&(s+=","),s+="?",options.newlines&&(s+="\n"),n+=1);return s+");"}}else s+=",(";for(options.newlines&&(s+="\n"),n=k=0;k<hdr.length;k+=1)if(incl[k]){if(tp=0===CSV.table.length?"VC":CSV.statsCnt[k].fieldType,v=k>=CSV.table[j].length?"":CSV.table[j][k],useNullForEmpty=!1,document.getElementById("ftype"+(k+1))&&(tp=document.getElementById("ftype"+(k+1)).value),document.getElementById("ftem"+(k+1))&&(tem=document.getElementById("ftem"+(k+1)).value),document.getElementById("ftrim"+(k+1))&&document.getElementById("ftrim"+(k+1)).checked&&(v=v.trim()),document.getElementById("chkupper"+(k+1))&&document.getElementById("chkupper"+(k+1)).checked&&(v=v.toUpperCase()),document.getElementById("chklower"+(k+1))&&document.getElementById("chklower"+(k+1)).checked&&(v=v.toLowerCase()),document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked&&(useNullForEmpty=!0),n>0&&(s+=","),""!==tem)s+="N"===tp||"NR"===tp||"I"===tp||"IT"===tp||"S"===tp||"D"===tp||"DT"===tp||"BI"===tp||"M"===tp||"L"===tp?""===v?tem.replace("{f}","NULL"):"D"==tp||"DT"==tp?tem.replace("{f}","'"+v.toSql()+"'"):tem.replace("{f}",v.toSql()):tem.replace("{f}","'"+v.toSql()+"'");else switch(tp){case"B":case"L":case"NR":case"M":case"S":case"N":case"BI":case"IT":case"I":""===v.trim()||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull?s+="NULL":s+=v.toSql();break;case"DT":case"D":if(""===v||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull)s+="NULL";else{if(options&&options.dateOutFormat&&""!==options.dateOutFormat)try{var vv=v;v=moment(v,CSV.dateformat[k]).format(options.dateOutFormat)}catch(e){v=vv}s+="'"+v.toSql()+"'"}break;default:"NULL"!=v.toUpperCase()&&"\\N"!==v||!options.useNullAsNull?s+=""===v&&useNullForEmpty?"NULL":"NC"===tp||"NVC"===tp?"N'"+v.toSql()+"'":"'"+v.toSql()+"'":s+="NULL"}options.newlines&&(s+="\n"),n+=1}!options.useTerseValues||j==CSV.table.length-1||cnt>=1*options.useTerseValuesSize?s+=");\n":s+=")\n"}break;case"U":for(temValuesSet=!1,j=0;j<(CSV.table.length?CSV.table.length:1);j+=1){for(where="",s+="UPDATE",""!==options.insertAfterText.trim()&&(s+=" "+options.insertAfterText.trim()),s+=" "+options.tableName+" SET ",options.newlines&&(s+="\n"),k=0;k<hdr.length;k+=1)keys[k]&&(where+=(""!==where?" AND ":"")+usrhdr[k]+"= {f"+k+"}");for(""===where&&(where=usrhdr[0]+"= {f0}"),n=k=0;k<hdr.length;k+=1){switch(incl[k]&&(n>0&&(s+=","),s+=usrhdr[k]+" = ",n+=1),tp=0===CSV.table.length?"VC":CSV.statsCnt[k].fieldType,v=0===CSV.table.length?"?":k>=CSV.table[j].length?"":CSV.table[j][k],useNullForEmpty=!1,document.getElementById("ftype"+(k+1))&&(tp=document.getElementById("ftype"+(k+1)).value),document.getElementById("ftem"+(k+1))&&(tem=document.getElementById("ftem"+(k+1)).value),document.getElementById("ftrim"+(k+1))&&document.getElementById("ftrim"+(k+1)).checked&&(v=v.trim()),document.getElementById("chkupper"+(k+1))&&document.getElementById("chkupper"+(k+1)).checked&&(v=v.toUpperCase()),document.getElementById("chklower"+(k+1))&&document.getElementById("chklower"+(k+1)).checked&&(v=v.toLowerCase()),document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked&&(useNullForEmpty=!0),""!==tem&&(s+="N"===tp||"NR"===tp||"I"===tp||"IT"===tp||"S"===tp||"D"===tp||"DT"===tp||"BI"===tp||"M"===tp||"L"===tp?""===v?tem.replace("{f}","NULL"):"D"==tp||"DT"==tp?tem.replace("{f}","'"+v.toSql()+"'"):tem.replace("{f}",v.toSql()):tem.replace("{f}","'"+v.toSql()+"'"),temValuesSet=!0),tp){case"B":case"L":case"NR":case"N":!temValuesSet&&incl[k]&&(""===v||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull?s+="NULL":0===CSV.table.length?s+=v:s+=v.toSql()),where=0===CSV.table.length?where.replace("{f"+k+"}",v):where.replace("{f"+k+"}",v.toSql());break;case"BI":case"IT":case"I":!temValuesSet&&incl[k]&&(""===v||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull?s+="NULL":0===CSV.table.length?s+=v:s+=v.toSql()),where=0===CSV.table.length?where.replace("{f"+k+"}",v):where.replace("{f"+k+"}",v.toSql());break;case"D":if(!temValuesSet&&incl[k])if(""===v||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull)s+="NULL";else if(0===CSV.table.length)s+=v;else{if(options&&options.dateOutFormat&&""!==options.dateOutFormat)try{vv=v,v=moment(v,CSV.dateformat[k]).format(options.dateOutFormat)}catch(e){v=vv}s+="'"+v.toSql()+"'"}where=0===CSV.table.length?where.replace("{f"+k+"}",v):where.replace("{f"+k+"}","'"+v.toSql()+"'");break;default:!temValuesSet&&incl[k]&&("NULL"!=v.toUpperCase()&&"\\N"!==v||!options.useNullAsNull?""===v&&useNullForEmpty?s+="NULL":"NC"===tp||"NVC"===tp?s+="N'"+v.toSql()+"'":0===CSV.table.length?s+=v:s+="'"+v.toSql()+"'":s+="NULL"),where="NC"===tp||"NVC"===tp?where.replace("{f"+k+"}","N'"+v.toSql()+"'"):0===CSV.table.length?where.replace("{f"+k+"}",v):where.replace("{f"+k+"}","'"+v.toSql()+"'")}incl[k]&&(options.newlines&&(s+="\n"),n+=1)}s+=" WHERE "+where,s+=";\n"}break;case"D":for(j=0;j<(CSV.table.length?CSV.table.length:1);j+=1){for(where="",s+="DELETE FROM "+options.tableName,options.newlines&&(s+="\n"),k=0;k<usrhdr.length;k+=1)keys[k]&&(where+=(""!==where?" AND ":"")+usrhdr[k]+"= {f"+k+"}");for(""===where&&(where=usrhdr[0]+"= {f0}"),n=k=0;k<hdr.length;k+=1){switch(n+=1,tp=0===CSV.table.length?"VC":CSV.statsCnt[k].fieldType,v=0===CSV.table.length?"?":k>=CSV.table[j].length?"":CSV.table[j][k],document.getElementById("ftype"+(k+1))&&(tp=document.getElementById("ftype"+(k+1)).value),document.getElementById("ftem"+(k+1))&&(tem=document.getElementById("ftem"+(k+1)).value),document.getElementById("ftrim"+(k+1))&&document.getElementById("ftrim"+(k+1)).checked&&(v=v.trim()),document.getElementById("chkupper"+(k+1))&&document.getElementById("chkupper"+(k+1)).checked&&(v=v.toUpperCase()),document.getElementById("chklower"+(k+1))&&document.getElementById("chklower"+(k+1)).checked&&(v=v.toLowerCase()),tp){case"B":case"L":case"NR":case"N":case"BI":case"IT":case"M":case"S":case"I":where=0===CSV.table.length?where.replace("{f"+k+"}",v):where.replace("{f"+k+"}",v.toSql());break;default:where="NC"===tp||"NVC"===tp?where.replace("{f"+k+"}","N'"+v.toSql()+"'"):0===CSV.table.length?where.replace("{f"+k+"}",v):where.replace("{f"+k+"}","'"+v.toSql()+"'")}options.newlines&&(s+="\n"),n+=1}s+=" WHERE "+where,s+=";\n"}break;case"M":for(row=batch=0,j=0;j<(CSV.table.length?CSV.table.length:1);j+=1){if(batch+=1,1===(row+=1)||batch==options.batchSize){for(s+="MERGE INTO "+options.tableName+" t\nUSING (\n",where="ON (",i=k=0;k<usrhdr.length;k+=1)keys[k]&&(where+=(i>0?" AND ":" ")+"t."+usrhdr[k]+"= s."+usrhdr[k],i+=1);"ON ("===where&&(where+="t."+usrhdr[0]+"= s."+usrhdr[0],keys.push(usrhdr[0])),where+=" )"}else(options.createTable||batch<options.batchSize)&&(s+="UNION ALL\n");for(options.newlines&&(s+="\n"),s+="SELECT ",includeNotKeyCnt=k=0;k<hdr.length;k+=1)incl[k]&&!keys[k]&&(includeNotKeyCnt+=1);for(n=k=0;k<hdr.length;k+=1)if(incl[k]||keys[k]){if(tp=0===CSV.table.length?"VC":CSV.statsCnt[k].fieldType,v=0===CSV.table.length?"?":k>=CSV.table[j].length?"":CSV.table[j][k],useNullForEmpty=!1,document.getElementById("ftype"+(k+1))&&(tp=document.getElementById("ftype"+(k+1)).value),document.getElementById("ftem"+(k+1))&&(tem=document.getElementById("ftem"+(k+1)).value),document.getElementById("ftrim"+(k+1))&&document.getElementById("ftrim"+(k+1)).checked&&(v=v.trim()),document.getElementById("chkupper"+(k+1))&&document.getElementById("chkupper"+(k+1)).checked&&(v=v.toUpperCase()),document.getElementById("chklower"+(k+1))&&document.getElementById("chklower"+(k+1)).checked&&(v=v.toLowerCase()),document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked&&(useNullForEmpty=!0),n>0&&(s+=","),""!==tem)"N"==tp||"NR"==tp||"I"==tp||"IT"==tp||"S"==tp||"D"==tp||"DT"==tp||"BI"==tp||"M"==tp||"L"===tp?""===v?s+=tem.replace("{f}","NULL"):"D"==tp||"DT"==tp?s+=tem.replace("{f}","'"+v.toSql()+"'"):0===CSV.table.length?s+=tmp.replace("{f}",v):s+=tem.replace("{f}",v.toSql()):0===CSV.table.length?s+=tmp.replace("{f}",v):s+=tem.replace("{f}","'"+v.toSql()+"'");else{switch(tp){case"B":case"L":case"NR":case"M":case"S":case"N":case"BI":case"IT":case"I":""===v.trim()||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull?s+="NULL":0===CSV.table.length?s+=v:s+=v.toSql();break;case"DT":case"D":if(""===v||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull)s+="NULL";else if(0===CSV.table.length)s+=v;else{if(options&&options.dateOutFormat&&""!==options.dateOutFormat)try{vv=v,v=moment(v,CSV.dateformat[k]).format(options.dateOutFormat)}catch(e){v=vv}s+="'"+v.toSql()+"'"}break;default:"NULL"!=v.toUpperCase()&&"\\N"!==v||!options.useNullAsNull?""===v&&useNullForEmpty?s+="NULL":"NC"===tp||"NVC"===tp?s+="N'"+v.toSql()+"'":0===CSV.table.length?s+=v:s+="'"+v.toSql()+"'":s+="NULL"}1===row&&(s+=" AS "+usrhdr[k])}options.newlines&&(s+="\n"),n+=1}if(options.dualNeeded&&(s+=" FROM "+(options.dualTableName||"myView")),j==CSV.table.length-1||batch==options.batchSize||0===CSV.table.length){if(s+="\n) s\n",s+=where,includeNotKeyCnt>0)for(s+="\n  WHEN MATCHED THEN \n     UPDATE SET ",n=k=0;k<usrhdr.length;k+=1)!keys[k]&&incl[k]&&(s+=(n>0?", ":" ")+"t."+usrhdr[k]+"=s."+usrhdr[k],n+=1);for(s+="\n  WHEN NOT MATCHED THEN\n     INSERT(",n=k=0;k<usrhdr.length;k+=1)(keys[k]||incl[k])&&(s+=(n>0?", ":" ")+usrhdr[k],n+=1);for(s+=")\n     VALUES(",n=k=0;k<usrhdr.length;k+=1)(keys[k]||incl[k])&&(s+=(n>0?", ":" ")+"s."+usrhdr[k],n+=1);s+=")\n;\n"}else s+="\n";if(batch==options.batchSize&&(batch=0),0===CSV.table.length)break}break;case"S":for(row=batch=0,options.createTable&&(options.batchSize=Number.MAX_VALUE),j=0;j<(CSV.table.length?CSV.table.length:1);j+=1){for(batch+=1,(row+=1)>1&&(options.createTable||batch<options.batchSize)&&(s+="UNION ALL\n"),options.newlines&&(s+="\n"),s+="SELECT ",n=k=0;k<hdr.length;k+=1)if(incl[k]){if(tp=0===CSV.table.length?"VC":CSV.statsCnt[k].fieldType,v=0===CSV.table.length?"":k>=CSV.table[j].length?"":CSV.table[j][k],useNullForEmpty=!1,document.getElementById("ftype"+(k+1))&&(tp=document.getElementById("ftype"+(k+1)).value),document.getElementById("ftem"+(k+1))&&(tem=document.getElementById("ftem"+(k+1)).value),document.getElementById("ftrim"+(k+1))&&document.getElementById("ftrim"+(k+1)).checked&&(v=v.trim()),document.getElementById("chkupper"+(k+1))&&document.getElementById("chkupper"+(k+1)).checked&&(v=v.toUpperCase()),document.getElementById("chklower"+(k+1))&&document.getElementById("chklower"+(k+1)).checked&&(v=v.toLowerCase()),document.getElementById("chknull"+(k+1))&&document.getElementById("chknull"+(k+1)).checked&&(useNullForEmpty=!0),n>0&&(s+=","),""!==tem)0===CSV.table.length?s+=tem.replace("{f}","?"):s+="N"===tp||"NR"===tp||"I"===tp||"IT"===tp||"S"===tp||"D"===tp||"DT"===tp||"BI"===tp||"M"===tp||"L"===tp?""===v?tem.replace("{f}","NULL"):"D"==tp||"DT"==tp?tem.replace("{f}","'"+v.toSql()+"'"):tem.replace("{f}",v.toSql()):tem.replace("{f}","'"+v.toSql()+"'");else switch(tp){case"B":case"L":case"NR":case"M":case"S":case"N":case"BI":case"IT":case"I":0===CSV.table.length?s+="?":""===v.trim()||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull?s+="NULL":s+=v.toSql();break;case"DT":case"D":if(0===CSV.table.length)s+="?";else if(""===v||("NULL"==v.toUpperCase()||"\\N"===v)&&options.useNullAsNull)s+="NULL";else{if(options&&options.dateOutFormat&&""!==options.dateOutFormat)try{vv=v,v=moment(v,CSV.dateformat[k]).format(options.dateOutFormat)}catch(e){v=vv}s+="'"+v.toSql()+"'"}break;default:0===CSV.table.length?s+="?":"NULL"!=v.toUpperCase()&&"\\N"!==v||!options.useNullAsNull?s+=""===v&&useNullForEmpty?"NULL":"NC"===tp||"NVC"===tp?"N'"+v.toSql()+"'":"'"+v.toSql()+"'":s+="NULL"}options.newlines&&(s+="\n"),n+=1,1===row&&(s+=" AS "+usrhdr[k])}options.dualNeeded&&(0!==CSV.table.length||options.createTable)&&(s+=" FROM "+(options.dualTableName||"myView")),j==CSV.table.length-1||batch==options.batchSize||0===CSV.table.length?s+=";\n":s+="\n",batch==options.batchSize&&(batch=0)}0!==CSV.table.length||options.createTable||((s=s.replace(/\?\sAS\s/gim," ").rtrim()).endsWith(";")&&(s=s.slice(0,-1)),s+="\nFROM "+(options.tableName||"mytable")+";")}return CSV.table.length,s}}function geoJsonToCsv(geo,delimiter,bIncludeHeaders,bQuotes,noMultiLines){var j,k,p,s="",value="",cols={},colArray=["latitude","longitude","altitude","geometry"],obj={},t="";if("string"==typeof geo)try{geo=JSON.parse(geo)}catch(e){geo=eval("geo="+geo)}var colnum=0;if("Feature"===geo.type&&(geo={type:"FeatureCollection",features:[geo]}),"FeatureCollection"===geo.type){for(j=0;j<geo.features.length;j+=1)"Point"===geo.features[j].geometry.type?("latitude"in cols||(cols.latitude=colnum+=1),"longitude"in cols||(cols.longitude=colnum+=1),"altitude"in cols||(cols.altitude=colnum+=1)):"coordinates"in cols||(cols.coordinates=colnum+=1,colArray.push("coordinates"));for(j=0;j<geo.features.length;j+=1)for(p in geo.features[j].properties)p in cols||(cols[p]=colnum+=1,colArray.push(p));if(bIncludeHeaders){for(j=0;j<colArray.length;j+=1)t+=colArray[j].toCsv(delimiter,'"','"',bQuotes)+delimiter;t=t.slice(0,-1*delimiter.length)+"\n"}for(j=0;j<geo.features.length;j+=1){"latitude"in cols&&geo.features[j].geometry&&geo.features[j].geometry.type&&geo.features[j].geometry.coordinates&&geo.features[j].geometry.coordinates.length>=2&&"Point"===geo.features[j].geometry.type?(s+=(bQuotes?'"':"")+geo.features[j].geometry.coordinates[1]+(bQuotes?'"':"")+delimiter,s+=(bQuotes?'"':"")+geo.features[j].geometry.coordinates[0]+(bQuotes?'"':"")+delimiter,geo.features[j].geometry.coordinates.length>2?s+=(bQuotes?'"':"")+geo.features[j].geometry.coordinates[2]+(bQuotes?'"':"")+delimiter:s+=(bQuotes?'""':"")+delimiter):(s+=(bQuotes?'""':"")+delimiter,s+=(bQuotes?'""':"")+delimiter,s+=(bQuotes?'""':"")+delimiter),geo.features[j].geometry.type?(value=geo.features[j].geometry.type,s+=(""+value).toCsv(delimiter,'"','"',bQuotes)+delimiter):s+=(bQuotes?'""':"")+delimiter,"coordinates"in cols&&("Point"!=geo.features[j].geometry.type?(value=geo.features[j].geometry.coordinates,"[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(value).slice(0,-1)),s+=(""+value).toCsv(delimiter,'"','"',bQuotes)+delimiter):s+=(bQuotes?'""':"")+delimiter);for(k=0;k<colArray.length;k+=1)p=colArray[k],"latitude"!=p&&"longitude"!==p&&"altitude"!==p&&"coordinates"!==p&&"geometry"!=p&&(p in geo.features[j].properties?(value=geo.features[j].properties[p],null===value&&(value=""),"[object Object]"==(value+"").substring(0,15)&&(value=JSON.valueArray(value).slice(0,-1)),noMultiLines&&(value=(value+"").replace(/\r\n|\r|\n/g," ")),s+=(value+"").toCsv(delimiter,'"','"',bQuotes)+delimiter):s+=(bQuotes?'""':"")+delimiter);s=s.slice(0,-1*delimiter.length)+"\n"}}return t+s}function htmlEscape(str){return String(str).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getCsvHeader(CSV){var k,hdr=[];if(CSV){CSV||alert("Missing CSV"),CSV.arHeaderRow||alert("Missing arHeaderRow");var big=CSV.arHeaderRow.length;for(big<CSV.maxColumnsFound&&(big=CSV.maxColumnsFound),k=0;k<big;k+=1)CSV.arHeaderRow[k]||CSV.arHeaderRow.push("FIELD"+(k+1)),hdr.push(CSV.arHeaderRow[k]),CSV.headerToUpper?(CSV.arHeaderRow[k]=CSV.arHeaderRow[k].toUpperCase(),hdr[hdr.length-1]=hdr[hdr.length-1].toUpperCase()):CSV.headerToLower&&(CSV.arHeaderRow[k]=CSV.arHeaderRow[k].toLowerCase(),hdr[hdr.length-1]=hdr[hdr.length-1].toLowerCase());return hdr}}function sqlOptions(CSV){if(CSV){var stats=getCsvColLength(CSV),hdr=getCsvHeader(CSV),s='<table class="table table-bordered table-hover table-condensed">\n<tr>\n<th>Col #</th>';s+="<th>Field Name</th>",s+="<th>Data Type</th><th>Max Size</th>",s+="<th title='# of decimals'>#<br/>Dec</th>",s+='<th>Key</th><th>Include<br/><input type="checkbox" checked onclick="setCheckboxes(\'finc\',this.checked)"/></th>',s+='<th>Required<br/><input type="checkbox" onclick="setCheckboxes(\'freq\',this.checked)"/></th>',s+='<th>Trim<br/><input type="checkbox" checked onclick="setCheckboxes(\'ftrim\',this.checked)"/></th>',s+="<th>Upper<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chkupper',this.checked);if(this.checked)setCheckboxes('chklower',false)\"/></th>",s+="<th>Lower<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chklower',this.checked);if(this.checked)setCheckboxes('chkupper',false)\"/></th>",s+='<th title="Use keyword NULL">Use NULL for Empty Field<br/><input type="checkbox" checked onclick="setCheckboxes(\'chknull\',this.checked)"/></th>',s+='<th title="Modify output by using {f} for field value. Ex: {f}+100">Template<br/>({f}=field)<br/>Ex: {f}+100</th></tr>';var j,template="<tr><td>{#}</td>";for(template+='<td><input type=text id="fname{#}" size="15" value="{FIELDNAME{#}}" title="{FTITLE{#}}"></td>\n',template+='<td><select id="ftype{#}" title="Choose data type of column" >',template+='<option value="VC" {VC{#}}>VarChar</option>',template+='<option value="NVC" {VC{#}}>NVarChar</option>',template+='<option value="VCC" {VCC{#}}>VarChar2</option>',template+='<option value="C" {C{#}}>Char</option>',template+='<option value="NC" {C{#}}>NChar</option>',template+='<option value="NR" {NR{#}}>Number</option>',template+='<option value="N" {N{#}}>Numeric</option>',template+='<option value="IT" {IT{#}}>Int</option>',template+='<option value="I" {I{#}}>Integer</option>',template+='<option value="BI" {I{#}}>BigInt</option>',template+='<option value="D" {D{#}}>Date</option>',template+='<option value="DT" {DT{#}}>Date Time</option>',template+='<option value="B" {B{#}}>Bit(0,1)</option>',template+='<option value="L" {L{#}}>Boolean</option>',template+='<option value="M" {M{#}}>Money</option>',template+='<option value="S" {S{#}}>Serial</option>',template+='</select>\n</td><td><input id="fsize{#}"size=4 maxlength=4 value="{FIELDSIZE{#}}"></td>\n',template+='<td><input id="fdec{#}"size=2 maxlength=2 value="{DECSIZE{#}}" readonly></td>',template+='<td><input type=checkbox id="fkey{#}"  value="Y" ></td>\n',template+='<td><input type=checkbox id="finc{#}"  value="Y" checked></td>\n',template+='<td><input type=checkbox id="freq{#}"  value="Y" ></td>\n',template+='<td><input type=checkbox id="ftrim{#}" value="Y" checked></td>\n',template+='<td><input type=checkbox id="chkupper{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chklower{#}\').checked=false"></td>\n',template+='<td><input type=checkbox id="chklower{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkupper{#}\').checked=false"></td>\n',template+='<td><input type=checkbox id="chknull{#}" value="Y" checked></td>\n',template+='<td><input type="text" id="ftem{#}" value="" size="15" maxlength="200"></td>',template+="</tr>",j=0;j<hdr.length;j+=1)s+=template.replace(/\{#\}/g,""+(j+1)).replace("{FIELDNAME"+(j+1)+"}",hdr[j].replace(/[@+<>"'?.,-\/#!$%\^&*;:{}=\-`~()\[\]\\|]/g,"").replace(/\s+/g,"_").replace(/_+/g,"_")).replace("{FIELDSIZE"+(j+1)+"}",0!==(stats.length>0&&stats[j])?stats[j]:30),0!==CSV.statsCnt.length?(s=(s="N"===CSV.statsCnt[j].fieldType?s.replace("{DECSIZE"+(j+1)+"}",CSV.statsCnt[j].fieldDecs):s.replace("{DECSIZE"+(j+1)+"}","")).replace("{FTITLE"+(j+1)+"}","Type:"+CSV.statsCnt[j].fieldType+",Counts: Total Records: "+CSV.table.length+",Empty Records:"+CSV.statsCnt[j].emptyCnt),"VC"===CSV.statsCnt[j].fieldType?s=s.replace("{VC"+(j+1)+"}","selected"):"VCC"===CSV.statsCnt[j].fieldType?s=s.replace("{VCC"+(j+1)+"}","selected"):"C"===CSV.statsCnt[j].fieldType?s=s.replace("{C"+(j+1)+"}","selected"):"N"===CSV.statsCnt[j].fieldType?s=s.replace("{N"+(j+1)+"}","selected"):"I"===CSV.statsCnt[j].fieldType?s=s.replace("{I"+(j+1)+"}","selected"):"B"===CSV.statsCnt[j].fieldType?s=s.replace("{B"+(j+1)+"}","selected"):"D"===CSV.statsCnt[j].fieldType?s=s.replace("{D"+(j+1)+"}","selected"):"S"===CSV.statsCnt[j].fieldType?s=s.replace("{S"+(j+1)+"}","selected"):"M"===CSV.statsCnt[j].fieldType&&(s=s.replace("{M"+(j+1)+"}","selected"))):s=(s=(s=s.replace("{VC"+(j+1)+"}","selected")).replace("{FTITLE"+(j+1)+"}","Type: Varchar,Counts: Total Records: "+CSV.table.length+",Empty Records: 0")).replace("{DECSIZE"+(j+1)+"}","");return s+="</table>"}}function setOptions(CSV){var j;if(CSV){var hdr=getCsvHeader(CSV);for(document.getElementById("fkey1")&&(document.getElementById("fkey1").checked=!0),document.getElementById("freq1")&&(document.getElementById("freq1").checked=!0),j=0;j<hdr.length;j+=1)document.getElementById("fname"+(j+1))&&(document.getElementById("fname"+(j+1)).value=hdr[j].replace(/[@+<>"'?.,-\/#!$%\^&*;:{}=\-`~()\[\]\\|]/g,"").replace(/\s+/g,"_").replace(/_+/g,"_"),document.getElementById("ftype"+(j+1))&&CSV.statsCnt[j]&&0===CSV.statsCnt[j].emptyCnt&&(document.getElementById("freq"+(j+1)).checked=!0))}}function minOptions(CSV){var inJsonForm=document&&document.getElementById("chkNullJson");if(CSV){var hdr=getCsvHeader(CSV),s='<table class="table table-bordered table-hover table-condensed">\n<tr>\n<th>Col #</th><th>Field</th>';s+='<th>Trim Left<br/><input type="checkbox" onclick="setCheckboxes(\'ftriml\',this.checked)"/></th>',s+='<th>Trim Right<br/><input type="checkbox" onclick="setCheckboxes(\'ftrimr\',this.checked)"/></th>',s+="<th>Upper<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chkupper',this.checked);if(this.checked){setCheckboxes('chklower',false);setCheckboxes('chkProper',false);}\"/></th>",s+="<th>Lower<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chklower',this.checked);if(this.checked){setCheckboxes('chkupper',false);setCheckboxes('chkProper',false);}\"/></th>",s+="<th title=\"1st letter of word capitalized the rest not\">Proper Case<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chkProper',this.checked);if(this.checked){setCheckboxes('chkupper',false);setCheckboxes('chklower',false);}\"/></th>",s+='<th>Remove Punctuation<br/><input type="checkbox" onclick="setCheckboxes(\'chkpunct\',this.checked)"/></th>',s+='<th>Crunch Spaces<br/><input type="checkbox" onclick="setCheckboxes(\'chkcrunch\',this.checked)"/></th>',inJsonForm&&(s+='<th>Use null for Empty Field<br/><input type="checkbox" onclick="setCheckboxes(\'chknull\',this.checked)"/></th>\n'),s+="<th># Decimals or Date Format</th>\n",s+="</tr>";var j,template="<tr><td>{#}</td>";for(template+="<td>{FIELDNAME{#}}</td>\n",template+='<td><input type=checkbox id="ftriml{#}" value="Y" title="Trim Left"></td>\n',template+='<td><input type=checkbox id="ftrimr{#}" value="Y" title="Trim Right"></td>\n',template+='<td><input type=checkbox id="chkupper{#}"  value="Y" onclick="if(this.checked){document.getElementById(\'chkProper{#}\').checked=document.getElementById(\'chklower{#}\').checked=false}"></td>\n',template+='<td><input type=checkbox id="chklower{#}"  value="Y" onclick="if(this.checked){document.getElementById(\'chkProper{#}\').checked=document.getElementById(\'chkupper{#}\').checked=false}"></td>\n',template+='<td><input type=checkbox id="chkProper{#}" value="Y" onclick="if(this.checked){document.getElementById(\'chklower{#}\').checked=document.getElementById(\'chkupper{#}\').checked=false}"></td>\n',template+='<td><input type=checkbox id="chkpunct{#}"  value="Y" title="Remove punctuation"></td>\n',template+='<td><input type=checkbox id="chkcrunch{#}" value="Y" title="Replace 2 or more spaces with 1"></td>\n',inJsonForm&&(template+='<td><input type=checkbox id="chknull{#}" value="Y" title="Use null instead of empty string"></td>\n'),template+='<td><input type="text" size="10" id="fdecimals{#}"  value=""  title="Specify # of decimal places or output date format"></td>\n',template+="</tr>",j=0;j<hdr.length;j+=1)s+=template.replace(/\{#\}/g,""+(j+1)).replace("{FIELDNAME"+(j+1)+"}",hdr[j].replace(/\s+/g,"_"));return s+="</table>"}}function flatOptions(CSV){if(CSV){var stats=getCsvColLength(CSV),hdr=getCsvHeader(CSV),s='<table class="table table-bordered table-hover table-condensed">\n<tr>\n<th>Col #</th><th>Field Name</th>';s+='<th>Trim<br/><input type="checkbox" onclick="setCheckboxes(\'ftrim\',this.checked)"/></th><th>Pad Size</th><th># Decimals or Date Format</th>',s+="<th>Upper<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chkupper',this.checked);if(this.checked){setCheckboxes('chklower',false);}\"/></th>",s+="<th>Lower<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chklower',this.checked);if(this.checked){setCheckboxes('chkupper',false);}\"/></th>",s+="<th>Right<br/>Justify<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chkrjust',this.checked);if(this.checked){setCheckboxes('chkcjust',false);}\"/></th>",s+="<th>Center<br/>Justify<br/><input type=\"checkbox\" onclick=\"setCheckboxes('chkcjust',this.checked);if(this.checked){setCheckboxes('chkrjust',false);}\"/></th></tr>";var j,template="<tr><td>{#}</td>";for(template+="<td>{FIELDNAME{#}}</td>\n",template+='<td><input type=checkbox id="ftrim{#}" value="Y" ></td>\n',template+='<td><input type=text id="fpadsize{#}" size=3 maxlength=3 value="{FIELDSIZE{#}}" ></td>\n',template+='<td><input type=text id="fdecimals{#}" size=10 value="" ></td>\n',template+='<td><input type=checkbox id="chkupper{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chklower{#}\').checked=false"></td>\n',template+='<td><input type=checkbox id="chklower{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkupper{#}\').checked=false"></td>\n',template+='<td><input type=checkbox id="chkrjust{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkcjust{#}\').checked=false"></td>\n',template+='<td><input type=checkbox id="chkcjust{#}"  value="Y" onclick="if(this.checked)document.getElementById(\'chkrjust{#}\').checked=false"></td>\n',template+="</tr>",j=0;j<hdr.length;j+=1)s+=template.replace(/\{#\}/g,""+(j+1)).replace("{FIELDNAME"+(j+1)+"}",hdr[j].replace(/\s+/g,"_")).replace("{FIELDSIZE"+(j+1)+"}",0!==(stats.length>0&&stats[j])?stats[j]:"");return s+="</table>"}}function parseAndOptions(CSV,forceOptions){var j,datefound=0;if(CSV){if(document.getElementById("txtRowLimit")&&(CSV.limit=document.getElementById("txtRowLimit").value),document.getElementById("txtSkipLimit")&&(CSV.skip=document.getElementById("txtSkipLimit").value),document.getElementById("chkHeader")&&(CSV.isFirstRowHeader=document.getElementById("chkHeader").checked),document.getElementById("chkHeaderUpper")&&(CSV.headerToUpper=document.getElementById("chkHeaderUpper").checked),document.getElementById("chkHeaderLower")&&(CSV.headerToLower=document.getElementById("chkHeaderLower").checked),document.getElementById("txt1")){for(CSV.parse(document.getElementById("txt1").value),j=0;j<CSV.maxColumnsFound;j+=1)CSV.statsCnt[j]&&"D"===CSV.statsCnt[j].fieldType&&(datefound+=1);detCsvDateFormat&&datefound>0?detCsvDateFormat(CSV):CSV.dateformat=void 0}if(document.getElementById("divOptions")&&(CSV.prevColumnsFound!=CSV.maxColumnsFound||forceOptions)&&(document.getElementById("divOptions").innerHTML=sqlOptions(CSV),setOptions(CSV),CSV.prevColumnsFound=CSV.maxColumnsFound),document.getElementById("divFlatOptions")&&(CSV.prevColumnsFound!=CSV.maxColumnsFound||forceOptions)&&(document.getElementById("divFlatOptions").innerHTML=flatOptions(CSV),CSV.prevColumnsFound=CSV.maxColumnsFound),document.getElementById("divMinOptions")&&(CSV.prevColumnsFound!=CSV.maxColumnsFound||forceOptions)&&(document.getElementById("divMinOptions").innerHTML=minOptions(CSV),CSV.prevColumnsFound=CSV.maxColumnsFound),document.getElementById("divInputCounts")){if(document.getElementById("divInputCounts").innerHTML="Input Records- Header: "+(0===CSV.arHeaderRow.length&&CSV.isFirstRowHeader?"missing":CSV.isFirstRowHeader+(CSV.isFirstRowHeader?" &nbsp; Header Fields: "+CSV.headerColumns:""))+"\n<br/>Data:  Separator: "+("\t"==CSV.delimiter?"Tab":" "==CSV.delimiter?"Space":CSV.delimiter||" ")+" &nbsp; &nbsp;  Fields: "+CSV.maxColumnsFound+" &nbsp; &nbsp;  Records: "+(CSV.dataRowsFound<=0?"0":CSV.dataRowsFound),CSV.isFirstRowHeader)for(j=0;j<CSV.arHeaderRow.length;j+=1)if(CSV.arHeaderRow[j].isNumeric()||""===CSV.arHeaderRow[j]){document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - Are you sure your First row is column names?";break}for(j=0;j<CSV.headerErrors.length;j+=1)document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - Heading column # "+CSV.headerErrors[j].field+" is empty.";for(CSV.skipEmptyRowCnt>0&&(document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - Empty lines skipped: "+CSV.skipEmptyRowCnt),CSV.isFirstRowHeader&&CSV.headerImbalance&&CSV.dataRowsFound>0?document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - Your column header has "+CSV.headerColumns+" columns but these lines do not: "+CSV.headerImbalanceRows:CSV.fieldImbalance&&(document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - Your first line has "+CSV.maxColumnsFound+" columns but these lines do not: "+CSV.fieldImbalanceRows),CSV.quote!=CSV.detectedQuote&&(document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - Are you sure your Quoting Character setting is correct? <small>(See Input Options)</small>"),j=0;j<CSV.statsCnt.length;j+=1)CSV.statsCnt[j]&&"D"!=CSV.statsCnt[j].fieldType&&(CSV.statsCnt[j].dateCnt-CSV.statsCnt[j].emptyCnt)/CSV.dataRowsFound>=.9&&(document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - Field: "+(CSV.arHeaderRow[j]||j+1)+" appears to be a DATE yet it has non-date values");var bad,cnt=0,msg=["","Spaces before quoting character","Data after quoting character","Missing end Quoting character"];for(bad in CSV.relaxedInfo){if((cnt+=1)>5){document.getElementById("divInputCounts").innerHTML+="<br/>...";break}document.getElementById("divInputCounts").innerHTML+="<br/><b>WARNING</b> - "+msg[CSV.relaxedInfo[bad].error]+" at line: "+bad+", Column:"+CSV.relaxedInfo[bad].column}}}}function clearAll(){var appendMode=!1;document.getElementById("chkAppend")&&(appendMode=document.getElementById("chkAppend").checked),document.getElementById("sepAuto")&&(document.getElementById("sepAuto").checked=!0),CSV&&(CSV.delimiter=",",CSV.autodetect=!0,CSV.quote='"',CSV.outputQuote='"',CSV.maxColumnsFound=0),document.getElementById("txt1")&&(document.getElementById("txt1").value=""),appendMode||document.getElementById("txta")&&(document.getElementById("txta").value=""),document.getElementById("txtCols")&&(document.getElementById("txtCols").value=""),document.getElementById("chkHeader")&&(document.getElementById("chkHeader").checked=!0),document.getElementById("chkHeaderUpper")&&(document.getElementById("chkHeaderUpper").checked=!1),document.getElementById("chkHeaderLower")&&(document.getElementById("chkHeaderLower").checked=!1),appendMode||document.getElementById("diva")&&(document.getElementById("diva").innerHTML=""),document.getElementById("divOptions")&&(document.getElementById("divOptions").innerHTML=""),document.getElementById("divFlatOptions")&&(document.getElementById("divFlatOptions").innerHTML=""),document.getElementById("divMinOptions")&&(document.getElementById("divMinOptions").innerHTML=""),document.getElementById("chkInputQuote")&&(document.getElementById("chkInputQuote").checked=!1),document.getElementById("chkOutputQuote")&&(document.getElementById("chkOutputQuote").checked=!1),document.getElementById("chkIgnoreDoubleQuote")&&(document.getElementById("chkIgnoreDoubleQuote").checked=!1),document.getElementById("chkDecodeLiterals")&&(document.getElementById("chkDecodeLiterals").checked=!1),parseAndOptions(),setupSortDD()}function getUserOptions(colpos){}function radiovalue(radioObj){if(!radioObj)return"";var radioLength=radioObj.length;if(void 0===radioLength)return radioObj.checked?radioObj.value:"";for(var i=0;i<radioLength;i+=1)if(radioObj[i].checked)return radioObj[i].value;return""}function setRadioValue(radioObj,newValue){if(radioObj){var radioLength=radioObj.length;if(void 0!==radioLength){"\t"===(newValue=(newValue||"")+"")&&(newValue="\\t");for(var i=0;i<radioLength;i+=1)radioObj[i].checked=!1,radioObj[i].value==newValue&&(radioObj[i].checked=!0)}else radioObj.checked=radioObj.value==newValue.toString()}}function sortStr(){var d,j,s;for(s="",j=1;j<=4;j+=1)document.getElementById("selSortFld"+j)&&""!==(d=document.getElementById("selSortFld"+j).value)&&(j>1&&(s+=","),s+=document.getElementById("selSortType"+j).value+d+document.getElementById("selSortAsc"+j).value);return CSV.setSortFlds(s),CSV.mySortNeeded=!0,s}function setupSortDD(){var dd,j,k,o;for(j=1;j<=4;j+=1)if(dd=document.getElementById("selSortFld"+j)){if(dd.options.length-1==CSV.maxColumnsFound)break;for(dd.options.length=1,dd.selectedIndex=0,k=1;k<=CSV.maxColumnsFound;k+=1)(o=document.createElement("option")).text=o.value=""+k,dd.options.add(o)}sortStr(),typeof csvCreateQueryUI==typeof Function&&csvCreateQueryUI(),document.getElementById("btnColsReset")&&document.getElementById("btnColsReset").click()}function getFldPosArr(CSV){var i,j,a=[];if(CSV){if(""!==CSV.displayPoss){for(a=CSV.displayPoss.split(","),i=0;i<a.length;i+=1)if(a[i]=(a[i]+"").trim(),isNaN(a[i])&&a[i]>" ")for(j=0;j<CSV.arHeaderRow.length;j+=1)(a[i]+"").toUpperCase()==CSV.arHeaderRow[j].toUpperCase()&&(a[i]=j+1);for(i=a.length-1;i>=0;i-=1)(isNaN(a[i])||a[i]<1||a[i]>CSV.maxColumnsFound)&&a.splice(i,1);for(i=0;i<a.length;i+=1)a[i]*=1}if(0===a.length)for(i=0;i<CSV.maxColumnsFound;i+=1)a[a.length]=i+1;if(0===a.length)for(i=0;i<CSV.arHeaderRow.length;i+=1)a[a.length]=i+1;return a}}function flattenSqlJson(data){var j,newo=[];for(j=0;j<data.length;j+=1){var rec={};for(k=0;k<data[j].length;k+=1)rec[data[j][k].column]=data[j][k].value;newo[j]=rec}return newo}function getExampleCsv(){return'id,name,amount,Remark\n1,"Johnson, Smith, and Jones Co.",345.33,Pays on time\n2,"Sam ""Mad Dog"" Smith",993.44,\n3,"Barney & Company",0,"Great to work with\nand always pays with cash."\n4,Johnson\'s Automotive,2344,\n'}function getExampleCsvJson(){return"id,name/first,name/last,rating/0,rating/1,rating/2\n1,Dan,Jones,8,7,9\n2,Bill,Barner,7,6,5\n3,Joe,Smoe,4,3,\n"}function getExampleXml(n){n=(n||1)-1;return'<?xml version="1.0"?>\n<ROWSET>\n<ROW>\n<id>1</id>\n<name>Johnson, Smith, and Jones Co.</name>\n<amount>345.33</amount>\n<Remark>Pays on time</Remark>\n</ROW>\n<ROW>\n<id>2</id>\n<name>Sam &quot;Mad Dog&quot; Smith</name>\n<amount>993.44</amount>\n<Remark></Remark>\n</ROW>\n<ROW>\n<id>3</id>\n<name>Barney &amp; Company</name>\n<amount>0</amount>\n<Remark>Great to work with\nand always pays with cash.</Remark>\n</ROW>\n<ROW>\n<id>4</id>\n<name>Johnson&apos;s Automotive</name>\n<amount>2344</amount>\n<Remark></Remark>\n</ROW>\n</ROWSET>'}function getExampleJson(n){return['[\n  {\n    "id":1,    "name":"Johnson, Smith, and Jones Co.",\n    "amount":345.33,    "Remark":"Pays on time"\n  },\n  {\n    "id":2,    "name":"Sam \\"Mad Dog\\" Smith",\n    "amount":993.44,    "Remark":""\n  },\n  {\n    "id":3,    "name":"Barney & Company",\n    "amount":0,    "Remark":"Great to work with\\nand always pays with cash."\n  },\n  {\n    "id":4,    "name":"Johnson\'s Automotive",\n    "amount":2344,    "Remark":""\n  }\n]\n','{ "data" : [\n  {    "id":1,    "name":"Johnson, Smith, and Jones Co."  },\n  {    "id":2,    "name":"Sam \\"Mad Dog\\" Smith"  },\n  {    "id":3,    "name":"Barney & Company"  },\n  {    "id":4,    "name":"Johnson\'s Automotive"  }\n] }\n','{ "race" : \n { "entries" : [\n  {    "id":11,    "name":"Johnson, Smith, and Jones Co."  },\n  {    "id":22,    "name":"Sam \\"Mad Dog\\" Smith"  },\n  {    "id":33,    "name":"Barney & Company"  },\n  {    "id":44,    "name":"Johnson\'s Automotive"  }\n] }\n}\n','{\n    "id":1,    "name":"Johnson, Smith, and Jones Co.",    "amount":345.33,    "Remark":"Pays on time"\n}\n','[\n    [      1,      "Johnson, Smith, and Jones Co.",      345.33    ],\n    [      99,      "Acme Food Inc.",      2993.55    ]\n]'][n=(n||1)-1]}function getExampleKml(){return'National Park,$ Obligated,State,Latitude,Longitude\nAbraham Lincoln Birthplace NHS,"$34,584",KY,37.6116333423,-85.6442940021\nAcadia,"$102,631",ME,44.3593807753,-68.2397319808\nAndersonville,"$65,133",GA,32.197905290823,-84.1302615685733\nAndrew Johnson ,"$17,949",TN,36.1562449930463,-82.8370902853041\nAntietam,"$54,743",MD,39.462381614,-77.7359854016\nAppomattox Court House,"$12,651",VA,37.3826448073,-78.8027430409\nAssateague Island,"$51,921",MD,38.0556022623662,-75.2453836072023\nBig Bend,"$535,983",TX,29.0103562389,-103.311115521\nBig South Fork National River and Recreation Area,"$3,009","TN, KY",36.3837375235,-84.6743069824\n'}function getExampleFlat(){return'1     Johnson, Smith, and Jones Co.  345.33     Pays on time                  \n2     Sam "Mad Dog" Smith            993.44              \n3     Barney & Company               0          Great to work with and always pays with cash.      \n4     Johnson\'s Automotive           2344        \n'}function getExampleGeoJson(n){return'{ \n    "type": "FeatureCollection",\n    "features": [\n      { "type": "Feature",\n        "geometry": {"type": "Point", "coordinates": [-75.343, 39.984]},\n        "properties": { \n          "name": "Location A",\n          "category": "Store"\n        }\n      },\n      { "type": "Feature",\n        "geometry": {"type": "Point", "coordinates": [-80.24, 40.12]},\n        "properties": { \n          "name": "Location B",\n          "category": "House"\n        }\n      },\n      { "type": "Feature",\n        "geometry": {"type": "Point", "coordinates": [ -77.2, 41.427]},\n        "properties": { \n          "name": "Location C",\n          "category": "Office"\n        }\n      }\n    ]\n  }'}function loadScript(url){var s=document.createElement("script");s.type="text/javascript",s.id="dynScriptTemp",s.src=url,document.getElementsByTagName("head")[0].appendChild(s)}function loadScriptAndRun(url){url.startsWith("?")||(url="?"+url),loadScript("https://www.convertcsv.com/cgi-bin/url-to-json.php"+url)}function loadDataAndRun(data){document.getElementById("txt1").value=data.html.join("\n"),document.getElementById("btnRun").click()}function loadURL(url){if(""===url.trim())return alert("Missing URL"),!1;loadScriptAndRun("?callback=loadDataAndRun&url="+encodeURIComponent(url))}function prettyJSON(text,step){var step=step||3;if("undefined"==typeof JSON)return text;try{if("string"==typeof text)return JSON.stringify(JSON.parse(text),null,step);if("object"==typeof text)return JSON.stringify(text,null,step)}catch(e){try{return A=eval("("+text+")"),JSON.stringify(A,null,step)}catch(e){}}return text}function getJsonLevel(o){"string"==typeof o&&(o=JSON.parse(o));var j,a,s=JSON.stringify(o,null,"\t").split(/\r\n|\n|\r/gm),level=0;for(j=0;j<s.length;j+=1)"\t"==s[j].charAt(0)&&(a=s[j].match(/\t+/gm))[0].length>level&&(level=a[0].length);return level+1}function saveOutput(text,fn,doctype){var blob=new Blob([text],{type:"text/plain;charset=utf-8"});saveAs(blob,fn,!0)}function saveExcel(id,resetCsv){var fn="convertcsv",old={};return resetCsv&&(old.autodetect=CSV.autodetect,old.isFirstRowHeader=CSV.isFirstRowHeader,old.quote=CSV.quote,old.delimiter=CSV.delimiter,old.table=CSV.table.slice(0)),document.getElementById("fn")&&(fn=document.getElementById("fn").value),CSV.autodetect=!0,CSV.isFirstRowHeader=!1,CSV.quote='"',document.getElementById("frm1")&&document.getElementById("outSepComma")&&(CSV.delimiter=radiovalue(document.frm1.outsep)||",","o"===CSV.delimiter&&(CSV.delimiter=document.getElementById("outSepOtherVal").value),CSV.autodetect=!1),document.getElementById("chkOutputQuote")&&document.getElementById("chkOutputQuote").checked&&(CSV.quote="'"),document.getElementById(id)?CSV.parse(document.getElementById(id).value):CSV.parse(id),alasql('SELECT * INTO XLSX("'+fn+'.xlsx",{headers:false}) FROM ?',[CSV.table]),resetCsv&&(CSV.autodetect=old.autodetect,CSV.isFirstRowHeader=old.isFirstRowHeader,CSV.quote=old.quote,CSV.delimiter=old.delimiter,CSV.table=old.table.slice(0),CSV.parse(CSV.stringify())),!1}function saveFile(text,ext){var eol="\r\n";null==ext&&(ext=""),""!==ext&&(ext="."+ext);var fn=document.getElementById("fn").value.trim();""===fn&&(fn=document.getElementById("fn").value="convertcsv"),document.getElementById("eol")&&(eol=document.getElementById("eol").value||eol),"LF"==eol&&(eol="\n"),"CRLF"==eol&&(eol="\r\n"),saveOutput(text.replace(/\r\n|\r|\n/gm,eol),fn+ext,null)}function loadCsv(){var delimiter="",q="",bs=0,acc="",idq="";storageSup.has_html5_storage()&&(null===storageSup.getCacheCsv()&&storageSup.setCacheCsv("N"),"Y"==storageSup.getCacheCsv()&&(document.getElementById("txt1")&&"Y"!=sessionStorage.getItem("clearPressed")&&(document.getElementById("chkHeader")&&(document.getElementById("chkHeader").checked="Y"==localStorage.getItem("csvChkHeader"),delimiter=localStorage.getItem("csvDelimiter"),setRadioValue(document.forms.frm1.sep,delimiter),q=localStorage.getItem("csvQuote"),bs=localStorage.getItem("csvBackslash"),acc=localStorage.getItem("chkReplaceAccents"),idq=localStorage.getItem("chkIgnoreDoubleQuote"),CSV.autodetect=!0,delimiter&&""!==delimiter&&(CSV.autodetect=!1,CSV.delimiter=delimiter),q&&""!==q&&(CSV.quote=q,document.getElementById("chkInputQuote")&&(document.getElementById("chkInputQuote").checked="'"===q)),idq&&""!==idq&&document.getElementById("chkIgnoreDoubleQuote")&&(CSV.ignoreQuote="Y"==idq,document.getElementById("chkIgnoreDoubleQuote").checked=CSV.ignoreQuote),acc&&""!==acc&&document.getElementById("chkReplaceAccents")&&(document.getElementById("chkReplaceAccents").checked="Y"===acc),CSV.decodeBackslashLiterals=!1,""!==bs&&(CSV.decodeBackslashLiterals="Y"===bs,document.getElementById("chkDecodeLiterals")&&(document.getElementById("chkDecodeLiterals").checked=CSV.decodeBackslashLiterals))),assignText(storageSup.getCsv())),sessionStorage.setItem("clearPressed","")))}function saveCsv(){var q=CSV.quote||'"',bs="N";storageSup.has_html5_storage()&&(document.getElementById("chkReplaceAccents")&&localStorage.setItem("chkReplaceAccents",document.getElementById("chkReplaceAccents").checked?"Y":""),document.getElementById("chkIgnoreDoubleQuote")&&localStorage.setItem("chkIgnoreDoubleQuote",document.getElementById("chkIgnoreDoubleQuote").checked?"Y":""),document.getElementById("chkDecodeLiterals")&&(bs=document.getElementById("chkDecodeLiterals").checked),document.getElementById("txt1")&&document.getElementById("txt1").value!=getExampleCsv()&&document.getElementById("txt1").value.length>0&&storageSup.putCsv(document.getElementById("txt1").value,document.getElementById("chkHeader").checked?"Y":"N",radiovalue(document.forms.frm1.sep),q,bs?"Y":"N"))}function clearPage(){storageSup&&storageSup.has_html5_storage()&&sessionStorage.setItem("clearPressed","Y"),window.location.reload(!0)}function doTransformations(v,k,CSV){var d;if(document.getElementById("ftrim"+(k+1))&&document.getElementById("ftrim"+(k+1)).checked&&(v=v.trim()),document.getElementById("ftriml"+(k+1))&&document.getElementById("ftriml"+(k+1)).checked&&(v=v.ltrim()),document.getElementById("ftrimr"+(k+1))&&document.getElementById("ftrimr"+(k+1)).checked&&(v=v.rtrim()),document.getElementById("chkupper"+(k+1))&&document.getElementById("chkupper"+(k+1)).checked&&(v=v.toUpperCase()),document.getElementById("chklower"+(k+1))&&document.getElementById("chklower"+(k+1)).checked&&(v=v.toLowerCase()),document.getElementById("chkProper"+(k+1))&&document.getElementById("chkProper"+(k+1)).checked&&(v=v.toProperCase()),document.getElementById("chkpunct"+(k+1))&&document.getElementById("chkpunct"+(k+1)).checked&&(CSV.statsCnt[k]?"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType&&(v=v.removePunctuation()):v=v.removePunctuation()),document.getElementById("chkcrunch"+(k+1))&&document.getElementById("chkcrunch"+(k+1)).checked&&(v=v.crunch()),document.getElementById("fdecimals"+(k+1))&&""!==document.getElementById("fdecimals"+(k+1)).value)if(d=document.getElementById("fdecimals"+(k+1)).value,!CSV.statsCnt[k]||"N"!=CSV.statsCnt[k].fieldType&&"I"!=CSV.statsCnt[k].fieldType&&"B"!=CSV.statsCnt[k].fieldType){if(""!==v.trim()&&CSV.statsCnt[k]&&("D"==CSV.statsCnt[k].fieldType||(CSV.statsCnt[k].dateCnt-CSV.statsCnt[k].emptyCnt)/CSV.dataRowsFound>=.9)){var vv=v;try{d=d.toUpperCase();v=moment(v,CSV.dateformat[k]).format(d)}catch(e){v=vv}}}else isNaN(d)?d=0:d*=1,""!==v.trim()&&(v=v.toNumber().toFixed(d)+"");return v}function setOutputSingleQuote(on){CSV.outputQuote=on?"'":'"'}function setInputSingleQuote(on){CSV.quote=on?"'":'"',parseAndOptions(CSV,!0)}function setCheckboxes(name,tf){var j,fld;for(j=0;j<CSV.maxColumnsFound;j+=1)(fld=document.getElementById(name+(j+1)))&&(fld.checked=tf)}var res={url:/((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gim},opt={},listcnt=0,toExcel=0;function initOpt(){opt.delimiter=radiovalue(document.forms[0].outsep),"o"==opt.delimiter&&(opt.delimiter=$("#outSepOtherVal")[0].value),opt.delimiter||(opt.delimiter=","),opt.limit=$("#chkLimit")[0].checked,opt.isRegex=!!$("#chkIsRegex")[0]&&$("#chkIsRegex")[0].checked,opt.social=$("#chkSocial")[0].checked,opt.socialReverse=$("#radShow")[0].checked,opt.anchor=$("#chkAnchor")[0].checked,opt.limitstr=$("#txtLimit")[0].value,opt.append=$("#chkAppend")[0].checked,opt.hdr=$("#chkCsvHeader")[0].checked,opt.forceCsv=$("#chkForceCsv")[0].checked,opt.dup=$("#chkDup")[0].checked,opt.sorted=$("#chkSort")[0].checked,opt.isList=$("#chkList")[0].checked,opt.includeFromUrl=!$("#chkIncludeFromUrl")[0]||$("#chkIncludeFromUrl")[0].checked,opt.heading="URL"}function assignText(inputString){$("#txt1")[0].value=inputString}function loadScriptAndRunRepeat(inputURL){inputURL.startsWith("?")||(inputURL="?"+inputURL),loadScript("https://www.convertcsv.com/cgi-bin/url-to-json.php"+inputURL)}function loadDataAndRunRepeat(input){opt.url=input.url||"",runit(input.html.join("\n"),opt)}function loadURLRepeat(inputURL){if(""==inputURL.trim())return!1;loadScriptAndRunRepeat("https://www.convertcsv.com?callback=loadDataAndRunRepeat&url="+encodeURIComponent(inputURL))}function runitonce(inputString,trueOrFalse){var index=0,tempArray1=[];if(initOpt(),listcnt=0,toExcel=trueOrFalse,opt.append||($("#txta")[0].value=""),opt.isList)for((tempArray1=inputString.split(/\r\n|\r|\n/)).length>0&&""===tempArray1[tempArray1.length-1].trim()&&tempArray1.splice(-1,1),index=0;index<tempArray1.length;index+=1)""!=tempArray1[index]&&(tempArray1[index].startsWith("http")||tempArray1[index].startsWith("ftp")||(tempArray1[index].startsWith("//")?tempArray1[index]="http:"+tempArray1[index]:tempArray1[index]=tempArray1[index]="http://"+tempArray1[index]));if(opt.cnt=tempArray1.length,opt.isList&&tempArray1.length>0)for(loadURLRepeat(tempArray1[0]),opt.append=!0,index=1;index<tempArray1.length;index+=1)""!==tempArray1[index].trim()&&loadURLRepeat(tempArray1[index]);else runit(inputString,opt)}function runit(inputString,opt){var index,index2,URLwithLinkTag,tempArray2=[],optHeading=opt.heading,numberOfCols=1*$("#txtNumCols")[0].value||1;numberOfCols<1&&(numberOfCols=1);var URLRegexCheck=res.url,listingURL=(tempArray2=inputString.match(URLRegexCheck)||[],$("#txtSocial")[0].value.split(/[ ,]/));if(listingURL=_.filter(listingURL,function(a){return a.trim().length>0}),opt.limit&&opt.limitstr.length>0)if(opt.isRegex){URLRegexCheck=null;try{URLRegexCheck=new RegExp(opt.limitstr,"i")}catch(e){}tempArray2=URLRegexCheck?_.reject(tempArray2,function(inputURL){return!URLRegexCheck.test(inputURL)}):_.reject(tempArray2,function(inputURL){return-1==inputURL.toLowerCase().indexOf(opt.limitstr.trim().toLowerCase())})}else tempArray2=_.reject(tempArray2,function(inputURL){return-1==inputURL.toLowerCase().indexOf(opt.limitstr.trim().toLowerCase())});opt.social&&(tempArray2=_.reject(tempArray2,function(inputURL){return opt.socialReverse?_.every(listingURL,function(input){return-1==inputURL.toLowerCase().indexOf(input.trim().toLowerCase())}):_.any(listingURL,function(input){return inputURL.toLowerCase().indexOf(input.trim().toLowerCase())>=0})})),opt.sorted&&(tempArray2=tempArray2.sort()),opt.dup&&(tempArray2=_.uniq(tempArray2,!0));var tempArray3=[];if(opt.hdr&&numberOfCols>1&&""===$("#txta")[0].value){for(tempArray3.push(optHeading+"1"),index=2;index<=numberOfCols;index+=1)tempArray3.push(optHeading+index);optHeading=tempArray3.join(opt.delimiter)}for(opt.hdr&&""===$("#txta")[0].value&&($("#txta")[0].value=optHeading,opt.isList&&1==numberOfCols&&($("#txta")[0].value+=opt.delimiter+"FROMURL"),$("#txta")[0].value+="\n"),index=0;index<tempArray2.length;){for(index2=0;index2<numberOfCols;index2+=1,index+=1)index<tempArray2.length&&(URLwithLinkTag=tempArray2[index],opt.anchor&&(URLwithLinkTag='<a href="'+URLwithLinkTag+'">'+URLwithLinkTag+"</a>"),opt.forceCsv&&(URLwithLinkTag=URLwithLinkTag.toCsv(opt.delimiter)),$("#txta")[0].value+=URLwithLinkTag),index2<numberOfCols-1&&($("#txta")[0].value+=opt.delimiter);opt.isList&&1==numberOfCols&&opt.includeFromUrl&&($("#txta")[0].value+=opt.delimiter+(opt.url||"")),$("#txta")[0].value+="\n"}opt.isList&&(listcnt+=1),toExcel&&(!opt.isList||listcnt>=opt.cnt)&&saveExcel("txta",!1)}
//# sourceMappingURL=header.min.js.map
